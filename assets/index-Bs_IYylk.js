import{r as n,j as e}from"./react-Dl5khTFu.js";import{c as Ie}from"./react-dom-CaK7Gm4w.js";import{a as X}from"./axios-upsvKRUO.js";import{C as we,a as ve,S as Ee,T as je,I as Me,Q as de,M as Qe,b as Pe,F as Te,c as Fe,D as _e,d as ze,U as Ne,L as Oe,e as ke,f as Se,B as Ce}from"./lucide-react-DP7f4JyI.js";import{S as Be}from"./react-select-DNjq-Jfl.js";import{H as He,a as xe}from"./html5-qrcode-DoJAUVNV.js";import{T as Ue,a as Ye,b as Ke,c as ce}from"./@radix-ui-FaNOjPFF.js";import"./hoist-non-react-statics-DUIF_pJT.js";import"./react-is-8JwjhRSi.js";import"./scheduler-CylivXx-.js";import"./@babel-DeGXz7kM.js";import"./@emotion-C1jRIs2C.js";import"./stylis-YPZU7XtI.js";import"./@floating-ui-DZ2V_EUC.js";import"./use-isomorphic-layout-effect-Do5Xa1W_.js";import"./memoize-one-DxrTgWdQ.js";(function(){const a=document.createElement("link").relList;if(a&&a.supports&&a.supports("modulepreload"))return;for(const h of document.querySelectorAll('link[rel="modulepreload"]'))m(h);new MutationObserver(h=>{for(const p of h)if(p.type==="childList")for(const w of p.addedNodes)w.tagName==="LINK"&&w.rel==="modulepreload"&&m(w)}).observe(document,{childList:!0,subtree:!0});function t(h){const p={};return h.integrity&&(p.integrity=h.integrity),h.referrerPolicy&&(p.referrerPolicy=h.referrerPolicy),h.crossOrigin==="use-credentials"?p.credentials="include":h.crossOrigin==="anonymous"?p.credentials="omit":p.credentials="same-origin",p}function m(h){if(h.ep)return;h.ep=!0;const p=t(h);fetch(h.href,p)}})();const Ge="/icm_lib/assets/img-Dm6ee46N.png",We="/icm_lib/assets/bookshelf-8M74edYe.png",G="https://religious-cherianne-dbprops-ef8ee171.koyeb.app",Le=n.createContext(),Ve=({children:r})=>{const[a,t]=n.useState("he"),m=p=>p==="he"?"rtl":"ltr",h=()=>{t(p=>p==="en"?"he":"en")};return e.jsx(Le.Provider,{value:{language:a,setLanguage:t,toggleLanguage:h,direction:m(a)},children:r})},te=()=>n.useContext(Le),Xe={by:"by",app_title:"Israeli Community of Madrid Library",title:"Book Title",author:"Author",description:"Description",year_of_publication:"Year of Publication",cover_type:"Cover Type",pages:"Pages",borrowing_child:"Borrowing Child's Name",borrowed_by:"Borrowed By",borrower:"Borrower",borrow:"Borrow Book",delivery_status:"Delivery Status",delivering_parent:"Delivering Parent",recommended_age:"Recommended Age",borrow_date:"Borrow Date",return_date:"Return Date",NotReturned:"Not Returned",add_book_label:"Add New Book",books:"Books",members:"Members",loans:"Loans",ShowAllLoans:"Show History",Hide_Details:"Hide Details",More_Details:"More Details",loan_status:"Availability",sort_by:"Order by",ascending:"Ascending",descending:"Descending",Hide_Add_Book:"Hide Add Book",Add_Book:"Add Book",return:"Return Book",Select_Book:"Select Book",Select_Book_State:"Select Book State",ScanQR:"Scan QR Code",download_qr_code:"Download QR Code",SendReminders:"Send Reminders",last_reminder:"last reminder at",no_reminder_sent:"No Reminders Sent",sending_reminders:"Sending...",send_x_reminders:"Send {count} Reminders",error_generating_report:"Failed to generate report. Please try again.",reports:"Reports",generate_report_button:"Generate report",select_borrower:"Select Borrower",add_member_button:"Add Member",edit_member:"Edit Member",delete_member:"Delete Member",close_add_member_button:"Close Add Member",add_member_form_title:"Add New Member",search_placeholder:"Search members by name",members_list_title:"Library Members",no_members_found:"No members found",select_all:"Select All",borrowed_books_label:"Borrowed books",parent_name_placeholder:"Parent's Name",kid_name_placeholder:"Kid's Name",parent_name_borrower:"Parent",kid_name_borrower:"Kid",email_placeholder:"Email Address",error_parent_name_required:"Parent's name is required.",error_kid_name_required:"Kid's name is required.",error_email_required:"Email address is required.",error_email_invalid:"Invalid email address.",email_missing_warning:"No email provided - notifications will not be sent to this member",confirm_delete_member:"Are you sure you want to delete this member?",no_email_provided:"No email provided",success_member_added:"Member added successfully!",success_member_updated:"Member updates successfully!",success_member_deleted:"Member deleted successfully!",parent_name_label:"Parent Name",kid_name_label:"Child Name",email_label:"Email",inventory_list_title:"Library Inventory",add_book_button:"Add Book",close_add_book_button:"Close Add Book",search_books_placeholder:"Search books by title",no_books_found:"No books found",placeholder_book_title:"Enter Book Title",placeholder_book_author:"Enter Author Name",placeholder_book_description:"Enter Description",placeholder_book_year:"Enter Year of Publication",placeholder_book_pages:"Enter Number of Pages",placeholder_book_recommended_age:"Enter Recommended Age",select_condition:"Select Condition",select_loan_status:"Select loan status",select_parent:"Select Parent",select_cover_type:"format",soft_cover:"Soft Cover",hard_cover:"Hard Cover",rigid_pages:"Rigid Pages",battery_book:"Book with Battery",new:"Like New",good:"Excellent - No noticeable wear",worn:"Good - Minor wear",available:"Available",borrowed:"Borrowed",error_book_title_required:"Book title is required.",error_book_author_required:"Author name is required.",error_book_description_required:"Description is required.",error_book_year_required:"Year of publication is required.",error_book_pages_required:"Number of pages is required.",cannot_delete_with_borrowed_books:"Cannot delete a member with borrowed books",inventory_report:"Inventory Report",loans_report:"Loans Report",select_report_type:"Select Report Type",report_options:"Report Options",select_field:"Select Field",book_title:"Book Title",id:"ID",order:"Order",include_history:"Include Historical Loans",include_borrowed:"Include Currently Borrowed Books",update_book_button:"Update book information",edit_book:"Edit book information",login_title:"Library Login",username:"Username",password:"Password",username_placeholder:"Enter username",password_placeholder:"Enter password",login_button:"Login",logging_in:"Logging in...",invalid_credentials:"Invalid username or password.",database_management:"Database Management",backup_database:"Backup Database",backup_description:"Create a backup of the current database. This will download a zip file containing the database and its associated files.",creating_backup:"Creating backup...",download_backup:"Download Database Backup",restore_database:"Restore Database",restore_description:"Restore the database from a previously created backup file (.zip or .db).",restore_warning:"Warning: This will overwrite the current database.",select_backup_file:"Select Backup file",accepted_file_types:"Accepted file types: .zip, .db",restoring_database:"Restoring database...",restore_database_button:"Restore Database",qr_codes_report:"Print QR Codes",qr_codes_available:"There are {count} QR codes available.",qr_codes_description:"This report generates a printable PDF of QR codes arranged in a grid with cutting guides.",inventory_report_description:"This report generates an Excel file with current inventory details. You can sort the data by various fields and choose to include borrowed items.",loans_report_description:"This report generates an Excel file of active loans. You can choose to include historical loans and sort by various fields.",start_qr:"From QR ID",end_qr:"End QR ID",end_qr_exceed_error:"End QR ID cannot exceed {qrCount}.",from_qr_greater_error:"From QR ID cannot be greater than To QR ID."},Je={by:"על ידי",app_title:"ספריית הקהילה הישראלית במדריד",title:"שם הספר",author:"שם המחבר",description:"תיאור",year_of_publication:"שנת הוצאה",cover_type:"סוג כריכה",pages:"עמודים",borrowing_child:"שם הילד המשאיל",borrowed_by:"הושאל על ידי",borrower:"המשאיל",borrow:"השאל ספר",delivery_status:"מצב מסירה",delivering_parent:"שם ההורה המוסר",recommended_age:"גיל מומלץ",borrow_date:"תאריך השאלה",return_date:"תאריך החזרה",NotReturned:"לא הוחזר",add_book_label:"הוסף ספר חדש",books:"ספרים",members:"חברים",loans:"השאלות",ShowAllLoans:"הצג היסטוריה",Hide_Details:"הסתר פרטים",More_Details:"עוד פרטים",loan_status:"זמינות",sort_by:"סדר לפי",ascending:"עולה",descending:"יורד",Hide_Add_Book:"הסתר הוספת ספר",Add_Book:"הוסף ספר",return:"החזר ספר",Select_Book:"בחר ספר",Select_Book_State:"מצב הספר",ScanQR:"סרוק ברקוד",download_qr_code:"הורד ברקוד",SendReminders:"שלח תזכורת",last_reminder:"תזכורת אחרונה ב",no_reminder_sent:"לא נשלחה תזכורת",sending_reminders:"שולח...",send_x_reminders:"שלח {count} תזכורות",error_generating_report:"הפקת הדוח נכשלה, נסה שנית בבקשה.",reports:"דוחות",generate_report_button:"הפק דוח",select_borrower:"בחר משאיל",add_member_button:"הוסף חבר",edit_member:"ערוך",delete_member:"מחק חבר",close_add_member_button:"סגור הוספת חבר",add_member_form_title:"הוספת חבר חדש",search_placeholder:"חפש חברים לפי שם",members_list_title:"חברי הספרייה",no_members_found:"לא נמצאו חברים",select_all:"בחר הכל",borrowed_books_label:"ספרים מושאלים",parent_name_placeholder:"שם ההורה המשאיל",kid_name_placeholder:"שם הילד המשאיל",parent_name_borrower:"ההורה",kid_name_borrower:"הילד",email_placeholder:"כתובת אימייל",error_parent_name_required:"נדרש שם הורה.",error_kid_name_required:"נדרש שם ילד.",error_email_required:"נדרשת כתובת אימייל.",error_email_invalid:"כתובת אימייל לא תקינה.",email_missing_warning:"לא סופק אימייל - לא יישלחו התראות לחבר זה",no_email_provided:"לא סופק אימייל",success_member_added:"החבר נוסף בהצלחה!",success_member_updated:"החבר עודכן בהצלחה!",success_member_deleted:"חבר נמחק בהצלחה!",parent_name_label:"שם ההורה",kid_name_label:"שם הילד",email_label:"אימייל",inventory_list_title:"מלאי הספרייה",add_book_button:"הוסף ספר",close_add_book_button:"סגור הוספת ספר",search_books_placeholder:"חפש ספרים לפי שם",no_books_found:"לא נמצאו ספרים",placeholder_book_title:"הכנס שם הספר",placeholder_book_author:"הכנס שם המחבר",placeholder_book_description:"הכנס תיאור",placeholder_book_year:"הכנס שנת הוצאה",placeholder_book_pages:"הכנס מספר עמודים",placeholder_book_recommended_age:"הכנס גיל מומלץ",select_condition:"מצב מסירה",select_loan_status:"זמינות",select_parent:"שם ההורה",select_cover_type:"פורמט",soft_cover:"כריכה רכה",hard_cover:"כריכה קשה",rigid_pages:"עמודים קשיחים",battery_book:"ספר עם בטריה",new:"כמו חדש",good:"מצויין - בלאי בלתי מורגש",worn:"טוב - בלאי קל",available:"זמין",borrowed:"מושאל",error_book_title_required:"נדרש שם ספר.",error_book_author_required:"נדרש שם מחבר.",error_book_description_required:"נדרש תיאור.",error_book_year_required:"נדרשת שנת הוצאה.",error_book_pages_required:"נדרש מספר עמודים.",confirm_delete_member:"האם אתה בטוח שברצונך למחוק חבר זה?",cannot_delete_with_borrowed_books:"לא ניתן למחוק חבר עם השאלות פתוחות",inventory_report:"דוח מלאי",loans_report:"דוח השאלות",select_report_type:"בחר סוג דוח",report_options:"אפשרויות דוח",select_field:"בחר שדה",book_title:"כותרת הספר",id:"מזהה",order:"סדר",include_history:"כלול היסטורית השאלות",include_borrowed:"כלול ספרים מושאלים",update_book_button:"עדכון ספר",edit_book:"ערוך ספר",login_title:"כניסה לספרייה",username:"שם משתמש",password:"סיסמה",username_placeholder:"הכנס שם משתמש",password_placeholder:"הכנס סיסמה",login_button:"כניסה",logging_in:"מתחבר...",invalid_credentials:"שם משתמש או סיסמה לא נכונים.",database_management:"ניהול מסד נתונים",backup_database:"גיבוי מסד נתונים",backup_description:"יצירת גיבוי של מסד הנתונים הנוכחי. פעולה זו תוריד קובץ zip המכיל את מסד הנתונים והקבצים הקשורים אליו.",creating_backup:"יוצר גיבוי...",download_backup:"הורדת גיבוי מסד נתונים",restore_database:"שחזור מסד נתונים",restore_description:"שחזור מסד הנתונים מקובץ גיבוי שנוצר בעבר (.zip או .db).",restore_warning:"אזהרה: פעולה זו תדרוס את מסד הנתונים הנוכחי.",select_backup_file:"בחר קובץ גיבוי",accepted_file_types:"סוגי קבצים מקובלים: .zip, .db",restoring_database:"משחזר מסד נתונים...",restore_database_button:"שחזור מסד נתונים",qr_codes_report:"הדפס קודי QR",qr_codes_available:"ישנם {count} קודי QR זמינים.",qr_codes_description:"דוח זה יפיק קובץ PDF להדפסה של קודי QR המסודרים ברשת עם קווים לחיתוך.",inventory_report_description:"דוח זה מייצר קובץ Excel עם פרטי המלאי הנוכחי. ניתן למיין את הנתונים לפי שדות שונים ולבחור לכלול פריטים מושאלים.",loans_report_description:"דוח זה מייצר קובץ Excel של הלוואות פעילות. ניתן לבחור לכלול הלוואות היסטוריות ולמיין לפי שדות שונים.",start_qr:"ממזהה QR",end_qr:"עד מזהה QR",end_qr_exceed_error:"מספר ה-QR הסופי לא יכול להיות גדול מ-{qrCount}.",from_qr_greater_error:"מספר ה-QR ההתחלתי לא יכול להיות גדול ממספר ה-QR הסופי."},ae=r=>r==="he"?Je:Xe,Ze=(r,a)=>({"כריכה רכה":a.soft_cover,"כריכה קשה":a.hard_cover,"עמודים קשיחים":a.rigid_pages,"ספר עם בטריה":a.battery_book})[r]||"N/A",er=(r,a)=>({"כמו חדש":a.new,"מצויין - בלאי בלתי מורגש":a.good,"טוב - בלאי קל":a.worn})[r]||"N/A",rr=({onLogin:r})=>{const[a,t]=n.useState(""),[m,h]=n.useState(""),[p,w]=n.useState(""),[E,Q]=n.useState(!1),{language:A,toggleLanguage:j,direction:_}=te(),B=ae(A),S=async q=>{q.preventDefault(),Q(!0);try{const x=await X.post(`${G}/api/login`,{username:a,password:m});x.status===200&&(localStorage.setItem("authToken",x.data.token),r())}catch{w(B.invalid_credentials)}Q(!1)};return e.jsxs("div",{className:`min-h-screen relative flex items-center justify-center ${_==="rtl"?"rtl":"ltr"}`,children:[e.jsx("div",{className:"absolute inset-0 bg-cover bg-center bg-no-repeat opacity-20",style:{backgroundImage:`url(${We})`,backgroundSize:"cover",backgroundPosition:"center",zIndex:0}}),e.jsx("button",{className:"w-10 h-10 flex items-center justify-center rounded-full border border-teal-500 bg-white/40 text-teal-500 shadow-md absolute top-2 left-2",onClick:()=>{j(),document.documentElement.dir=_==="rtl"?"ltr":"rtl"},style:{zIndex:50},children:A==="en"?"HE":"EN"}),e.jsxs("div",{className:"relative z-10 w-full max-w-[320px] sm:max-w-[380px] mx-4 rounded-3xl overflow-hidden shadow-xl",children:[e.jsx("div",{className:"bg-white rounded-3xl p-4",children:e.jsx("img",{src:Ge,alt:"ICM Library Logo",className:"h-12 sm:h-16 w-auto mx-auto"})}),e.jsx("div",{className:"transition-all duration-300",children:e.jsxs("form",{onSubmit:S,className:"backdrop-blur-sm bg-white/20 p-6 sm:p-8 rounded-3xl",children:[e.jsx("h1",{className:"text-xl sm:text-2xl font-bold mb-4 sm:mb-6 text-center text-gray-800",children:B.login_title}),p&&e.jsx("div",{className:"text-red-500 text-sm mb-4 bg-red-50 p-2 rounded",children:p}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-gray-700 text-sm font-medium mb-2",children:B.username}),e.jsx("input",{type:"text",className:`w-full p-2.5 sm:p-3 border border-gray-200 rounded-md\r
                                             bg-white/50 backdrop-blur-sm focus:ring-2\r
                                             focus:ring-blue-500 focus:border-transparent`,value:a,onChange:q=>t(q.target.value),placeholder:B.username_placeholder,dir:_==="rtl"?"rtl":"ltr"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-gray-700 text-sm font-medium mb-2",children:B.password}),e.jsx("input",{type:"password",className:`w-full p-2.5 sm:p-3 border border-gray-200 rounded-md\r
                                             bg-white/50 backdrop-blur-sm focus:ring-2\r
                                             focus:ring-blue-500 focus:border-transparent`,value:m,onChange:q=>h(q.target.value),placeholder:B.password_placeholder,dir:_==="rtl"?"rtl":"ltr"})]}),e.jsx("button",{type:"submit",className:`w-full py-2.5 sm:py-3 rounded-md transition duration-200 
                                         ${E?"bg-gray-400 cursor-not-allowed":"bg-blue-500 hover:bg-blue-600 active:bg-blue-700"} text-white font-semibold shadow-md`,disabled:E,children:E?B.logging_in:B.login_button})]})]})})]})]})},M=X.create({baseURL:G});M.interceptors.request.use(r=>{const a=localStorage.getItem("authToken");return console.log("Token in localStorage:",a),a&&(r.headers.Authorization=a),r},r=>Promise.reject(r));M.interceptors.response.use(r=>r,r=>(r.response&&r.response.status===403&&(localStorage.removeItem("authToken"),alert("Session expired. Please log in again."),window.location.reload()),Promise.reject(r)));const tr=async r=>{try{return(await M.post("/api/members",r)).data}catch{throw new Error("Failed to add member.")}},De=async()=>{try{return(await M.get("/api/members")).data.map(a=>({...a,borrowed_books_count:a.borrowed_books_count||0}))}catch(r){throw console.error("Error fetching members:",r),r}},ar=async r=>{try{return(await M.get(`/api/members/${r}/loans`)).data.loans}catch(a){throw console.error(`Error fetching loans for member ${r}:`,a),a}},sr=async(r,a)=>{try{return(await M.put(`/api/members/${r}`,a)).data}catch(t){throw console.error("Error updating member:",t),t}},or=async r=>{try{return(await M.delete(`/api/members/${r}`)).data}catch(a){throw console.error("Error deleting member:",a),a}},nr=async(r="desc")=>{try{return(await X.get(`${G}/api/books?order_by=${r}`)).data}catch(a){throw console.error("Error fetching books:",a),a}},lr=async r=>{try{return(await M.post("/api/books",r,{headers:{"Content-Type":"application/json"}})).data}catch(a){throw console.error("Error adding book:",a),new Error("Failed to add book.")}},ir=async r=>{try{const a=await X.get(`${G}/api/qr_codes/${r}`,{responseType:"blob"}),t=window.URL.createObjectURL(new Blob([a.data])),m=document.createElement("a");m.href=t,m.setAttribute("download",r),document.body.appendChild(m),m.click(),m.remove()}catch(a){throw console.error("Error downloading QR code:",a),a}},cr=async(r,a)=>{try{return(await M.put(`${G}/api/books/${r}`,a)).data}catch(t){throw console.error("Error updating book:",t),t}},dr=()=>{const[r,a]=n.useState([]),[t,m]=n.useState("desc"),[h,p]=n.useState(""),[w,E]=n.useState(""),[Q,A]=n.useState(""),[j,_]=n.useState(""),[B,S]=n.useState(""),[q,x]=n.useState(""),[f,y]=n.useState(""),[P,u]=n.useState(""),[C]=n.useState("available"),[R,N]=n.useState(""),[$,k]=n.useState([]),[L,I]=n.useState(!1),[T,W]=n.useState(""),[V,z]=n.useState({}),{language:H,toggleLanguage:J,direction:d}=te(),l=ae(H),[U,b]=n.useState(null),[c,D]=n.useState(""),Z=[{value:"כריכה רכה",label:l.soft_cover},{value:"כריכה קשה",label:l.hard_cover},{value:"עמודים קשיחים",label:l.rigid_pages},{value:"ספר עם בטריה",label:l.battery_book}],Y=[{value:"כמו חדש",label:l.new},{value:"מצויין - בלאי בלתי מורגש",label:l.good},{value:"טוב - בלאי קל",label:l.worn}];n.useEffect(()=>{oe(),me()},[t]),n.useEffect(()=>{window.scrollTo({top:0,behavior:"smooth"})},[]);const oe=async()=>{try{const o=await nr(t);Array.isArray(o)?a(o):(console.error("Unexpected response format:",o),a([]))}catch(o){console.error("Failed to load books:",o),a([])}},me=async()=>{try{const o=await De();k(o)}catch(o){console.error("Error fetching members:",o)}},pe=async o=>{o.preventDefault();try{const K={title:h,author:w,description:Q,year_of_publication:j,pages:B,cover_type:q,book_condition:f||"טוב - בלאי קל",recommended_age:P,loan_status:C,delivering_parent:R};U?await cr(U,K):await lr(K),b(null),D(""),p(""),E(""),A(""),_(""),S(""),x(Z[0].value),y(Y[0].value),N(""),I(!1),await oe()}catch(K){console.error("Error saving book:",K)}},be=o=>{I(!0),b(o.id),D(o.qr_code),p(o.title),E(o.author||""),A(o.description||""),_(o.year_of_publication||""),S(o.pages||""),x(o.cover_type||""),y(o.book_condition||""),u(o.recommended_age||""),N(o.delivering_parent||"")},he=o=>{z(K=>({...K,[o]:!K[o]}))},ne=o=>{ir(o).then(()=>console.log("QR Code downloaded successfully")).catch(K=>console.error("Failed to download QR Code:",K))};return e.jsxs("div",{className:"w-full max-w-md mx-auto",children:[e.jsx("button",{className:"w-10 h-10 flex items-center justify-center rounded-full border border-teal-500 bg-white/50 text-teal-500 shadow-md absolute top-2 left-2",onClick:J,children:H==="en"?"HE":"EN"}),e.jsx("div",{className:"flex flex-col mb-4",children:e.jsx("input",{id:"search_by_name",type:"text",placeholder:l.search_books_placeholder,value:T,onChange:o=>W(o.target.value),className:`flex-1 border border-gray-300 rounded-md py-1.5 px-4 ${H==="he"?"text-right":"text-left"}`})}),e.jsx("button",{onClick:()=>I(!L),className:"w-full bg-blue-500 text-white font-semibold py-2 rounded-md hover:bg-blue-600 transition mb-4",children:L?`- ${l.close_add_book_button}`:`+ ${l.add_book_button}`}),L&&e.jsxs("form",{onSubmit:pe,className:"mb-4",children:[e.jsx("input",{type:"text",value:h,onChange:o=>p(o.target.value),placeholder:l.placeholder_book_title,className:"input mb-2 w-full border border-gray-300 rounded-md py-2 px-4"}),e.jsx("input",{type:"text",value:w,onChange:o=>E(o.target.value),placeholder:l.placeholder_book_author,className:"input mb-2 w-full border border-gray-300 rounded-md py-2 px-4"}),e.jsx("textarea",{value:Q,onChange:o=>A(o.target.value),onInput:o=>{o.target.style.height="auto",o.target.style.height=`${o.target.scrollHeight}px`},placeholder:l.placeholder_book_description,className:"input mb-2 w-full border border-gray-300 rounded-md py-2 px-4"}),e.jsx("input",{type:"number",value:j,onChange:o=>_(o.target.value),placeholder:l.placeholder_book_year,className:"input mb-2 w-full border border-gray-300 rounded-md py-2 px-4"}),e.jsxs("select",{value:q,onChange:o=>x(o.target.value),className:"input mb-2 w-full border border-gray-300 rounded-md py-2 px-4",children:[e.jsx("option",{value:"",children:l.select_cover_type}),Z.map(o=>e.jsx("option",{value:o.value,children:o.label},o.value))]}),e.jsx("input",{type:"number",value:B,onChange:o=>S(o.target.value),placeholder:l.placeholder_book_pages,className:"input mb-2 w-full border border-gray-300 rounded-md py-2 px-4"}),e.jsx("input",{type:"number",value:P,onChange:o=>u(o.target.value),placeholder:l.placeholder_book_recommended_age,className:"input mb-2 w-full border border-gray-300 rounded-md py-2 px-4"}),e.jsxs("select",{value:f,onChange:o=>y(o.target.value),className:"input mb-2 w-full border border-gray-300 rounded-md py-2 px-4",children:[e.jsx("option",{value:"",children:l.select_condition}),Y.map(o=>e.jsx("option",{value:o.value,children:o.label},o.value))]}),e.jsxs("select",{value:R,onChange:o=>N(o.target.value),className:"input mb-2 w-full border border-gray-300 rounded-md py-2 px-4",children:[e.jsx("option",{value:"",children:l.select_parent}),$.map(o=>e.jsx("option",{value:o.parent_name,children:o.parent_name},o.id))]}),e.jsx("button",{type:"submit",className:"w-full bg-green-500 text-white font-semibold py-2 rounded-md hover:bg-green-600 transition",children:U?l.update_book_button:l.add_book_button})]}),e.jsxs("div",{className:`w-full border-b border-gray-300 bg-gray-100 py-2 px-4 flex ${H==="he"?"flex-row-reverse":"flex-row"} justify-between items-center cursor-pointer`,onClick:()=>m(t==="desc"?"asc":"desc"),"aria-label":l.sort_by,children:[e.jsx("span",{className:"font-semibold text-gray-700",children:l.title}),t==="desc"?e.jsx(we,{size:20}):e.jsx(ve,{size:20})]}),e.jsx("div",{dir:d,children:e.jsx("div",{className:"overflow-y-auto max-h-screen border-t pt-4",children:r.filter(o=>o.title.toLowerCase().includes(T.toLowerCase())||o.author.toLowerCase().includes(T.toLowerCase())).map(o=>e.jsxs("div",{className:"bg-gray-50 shadow-sm rounded-lg p-4 mb-2 relative",children:[e.jsxs("div",{className:"mb-12",children:[e.jsx("h2",{className:"font-bold text-gray-800",children:o.title}),e.jsx("p",{className:"text-sm text-gray-500",children:o.author}),e.jsxs("p",{className:"text-sm mb-4",children:[e.jsx("span",{className:o.loan_status==="available"?"text-green-500":"text-red-500",children:o.loan_status==="borrowed"?l.borrowed:l.available}),o.loan_status==="borrowed"&&e.jsxs("span",{children:[" ",l.by," ",o.borrowing_child]})]}),e.jsx("button",{onClick:()=>ne(`${o.qr_code}.png`),className:"text-blue-600 text-sm px-3 py-1 rounded-md border border-blue-600 hover:bg-blue-50 transition-colors duration-200",children:l.download_qr_code})]}),e.jsxs("div",{className:"absolute bottom-4 inset-x-4 flex justify-between items-center",children:[e.jsx("button",{onClick:()=>be(o),className:"p-2 text-gray-600 hover:text-emerald-600 transition-colors duration-200","aria-label":l.edit_book,children:e.jsx(Ee,{size:20})}),e.jsx("button",{onClick:()=>he(o.qr_code),className:"flex items-center gap-1 text-gray-600 hover:text-indigo-600 transition-colors duration-200",children:V[o.qr_code]?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"text-sm",children:l.Hide_Details}),e.jsx(ve,{size:20})]}):e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"text-sm",children:l.More_Details}),e.jsx(we,{size:20})]})}),e.jsx("div",{className:"w-8","aria-hidden":"true"})]}),V[o.qr_code]&&e.jsxs("div",{className:"mt-8 mb-8 text-gray-600 bg-white p-4 rounded-md border border-gray-100",children:[e.jsxs("p",{children:[e.jsxs("strong",{children:[l.description,":"]})," ",o.description||"N/A"]}),e.jsxs("p",{children:[e.jsxs("strong",{children:[l.year_of_publication,":"]})," ",o.year_of_publication||"N/A"]}),e.jsxs("p",{children:[e.jsxs("strong",{children:[l.cover_type,":"]})," ",Ze(o.cover_type,l)]}),e.jsxs("p",{children:[e.jsxs("strong",{children:[l.pages,":"]})," ",o.pages||"N/A"]}),e.jsxs("p",{children:[e.jsxs("strong",{children:[l.recommended_age,":"]})," ",o.recommended_age||"N/A"]}),e.jsxs("p",{children:[e.jsxs("strong",{children:[l.select_condition,":"]})," ",er(o.book_condition,l)]}),e.jsxs("p",{children:[e.jsxs("strong",{children:[l.delivering_parent,":"]})," ",o.delivering_parent||"N/A"]})]})]},o.qr_code))})})]})};function ur(){const[r,a]=n.useState([]),[t,m]=n.useState(""),[h,p]=n.useState(""),[w,E]=n.useState(""),[Q,A]=n.useState(!1),[j,_]=n.useState(""),[B,S]=n.useState({}),[q,x]=n.useState(""),{language:f,toggleLanguage:y,direction:P}=te(),u=ae(f),[C,R]=n.useState(null),[N,$]=n.useState(null),[k,L]=n.useState({}),I=()=>{const d={};return t.trim()||(d.parentName=u.error_parent_name_required),h.trim()||(d.kidName=u.error_kid_name_required),w.trim()&&!/\S+@\S+\.\S+/.test(w)&&(d.email=u.error_email_invalid),S(d),Object.keys(d).length===0},T=async d=>{if(d.preventDefault(),!!I()){w.trim()||alert(u.email_missing_warning);try{const l={parent_name:t,kid_name:h,email:w};C?await sr(C,l):await tr(l),R(null),m(""),p(""),E(""),S({}),x(C?u.success_member_updated:u.success_member_added),await z()}catch(l){console.error("Error saving member:",l),x("")}}},W=async d=>{if(window.confirm(u.confirm_delete_member))try{await or(d),x(u.success_member_deleted),await z()}catch(l){console.error("Error deleting member:",l),alert("Cannot delete member: they have open loans.")}},V=d=>{R(d.id),m(d.parent_name),p(d.kid_name),E(d.email),A(!0)},z=async()=>{try{const d=await De();Array.isArray(d)?a(d):(console.error("Unexpected response format:",d),a([]))}catch(d){console.error("Failed to load members:",d),a([])}};n.useEffect(()=>{z()},[]);const H=async d=>{if(N===d)$(null);else if($(d),!k[d])try{const l=await ar(d);L(U=>({...U,[d]:l}))}catch(l){console.error("Error fetching loans:",l)}},J=Array.isArray(r)?r.filter(d=>d.parent_name.toLowerCase().includes(j.toLowerCase())||d.kid_name.toLowerCase().includes(j.toLowerCase())):[];return e.jsxs("div",{className:"w-full max-w-md mx-auto",children:[e.jsx("button",{className:"w-10 h-10 flex items-center justify-center rounded-full border border-teal-500 bg-white/50 text-teal-500 shadow-md absolute top-2 left-2",onClick:y,children:f==="en"?"HE":"EN"}),e.jsx("button",{onClick:()=>A(!Q),className:"w-full bg-blue-500 text-white font-semibold py-2 rounded-md hover:bg-blue-600 transition mb-4",children:Q?`- ${u.close_add_member_button}`:`+ ${u.add_member_button}`}),Q&&e.jsxs("form",{onSubmit:T,className:"mb-4",children:[e.jsx("input",{type:"text",placeholder:u.parent_name_placeholder,value:t,onChange:d=>m(d.target.value),className:"input mb-2 w-full border border-gray-300 rounded-md py-2 px-4"}),B.parentName&&e.jsx("p",{className:"text-red-500 text-sm",children:B.parentName}),e.jsx("input",{type:"text",placeholder:u.kid_name_placeholder,value:h,onChange:d=>p(d.target.value),className:"input mb-2 w-full border border-gray-300 rounded-md py-2 px-4"}),B.kidName&&e.jsx("p",{className:"text-red-500 text-sm",children:B.kidName}),e.jsx("input",{type:"email",placeholder:u.email_placeholder,value:w,onChange:d=>E(d.target.value),className:"input mb-2 w-full border border-gray-300 rounded-md py-2 px-4"}),B.email&&e.jsx("p",{className:"text-red-500 text-sm",children:B.email}),e.jsx("button",{type:"submit",className:"w-full bg-green-500 text-white font-semibold py-2 rounded-md hover:bg-green-600 transition",children:u.add_member_button}),q&&e.jsx("p",{className:"text-green-500 text-sm mt-2",children:q})]}),e.jsx("input",{type:"text",placeholder:u.search_placeholder,value:j,onChange:d=>_(d.target.value),className:`input w-full border border-gray-300 rounded-md py-2 px-4 mb-4 ${f==="he"?"text-right":"text-left"} ${f==="he"?"rtl":"ltr"}`}),e.jsx("div",{dir:P,children:e.jsx("div",{className:"overflow-y-auto max-h-96 border-t pt-4",children:J.map(d=>e.jsxs("div",{className:"bg-gray-50 shadow-sm rounded-lg p-4 mb-2 relative",children:[e.jsxs("div",{className:"mb-4",children:[e.jsxs("h2",{className:"font-bold text-gray-800",children:[u.parent_name_label,": ",d.parent_name]}),e.jsxs("p",{className:"text-sm text-gray-500",children:[u.kid_name_label,": ",d.kid_name]}),e.jsxs("p",{className:"text-sm mb-2 text-gray-500",children:[u.email_label,": ",d.email||u.no_email_provided]}),e.jsxs("p",{className:"text-sm mb-8 text-gray-700 font-semibold",children:[u.borrowed_books_label,": ",d.borrowed_books_count]}),N===d.id&&k[d.id]&&e.jsxs("div",{className:"mt-2 p-2 bg-gray-100 rounded",children:[e.jsx("h3",{className:"font-semibold text-gray-700",children:u.borrowed_books_label}),e.jsx("ul",{children:k[d.id].map((l,U)=>e.jsxs("li",{className:"text-sm text-gray-600",children:[l.book_title," (",u.borrow_date,": ",l.borrowed_at,")"]},U))})]})]}),e.jsx("div",{className:"absolute bottom-4 inset-x-4 flex justify-between items-center",children:e.jsxs("div",{className:"flex gap-2",children:[d.borrowed_books_count>0?e.jsxs("button",{onClick:()=>alert(u.cannot_delete_with_borrowed_books),className:"text-gray-400 cursor-not-allowed relative","aria-label":u.cannot_delete_with_borrowed_books,children:[e.jsx(je,{size:20}),e.jsx("div",{className:"absolute inset-0 flex items-center justify-center pointer-events-none",children:e.jsx("div",{className:"w-[28px] h-[2px] bg-gray-400 rotate-45 absolute"})})]}):e.jsx("button",{onClick:()=>W(d.id),className:"text-gray-600 hover:text-red-600 transition-colors duration-200","aria-label":u.delete_member,children:e.jsx(je,{size:20})}),e.jsx("button",{onClick:()=>V(d),className:"text-gray-600 hover:text-emerald-600 transition-colors duration-200","aria-label":u.edit_member,children:e.jsx(Ee,{size:20})}),d.borrowed_books_count>0&&e.jsx("button",{onClick:()=>H(d.id),className:"text-gray-600 hover:text-blue-600 transition-colors duration-200","aria-label":u.More_Details,children:e.jsx(Me,{size:20})})]})})]},d.id))})})]})}async function fe(){return await(await X.get(`${G}/api/available_books`)).data}async function ye(){return await(await X.get(`${G}/api/borrowed_books`)).data}async function mr(r){return await(await X.get(`${G}/api/book/${r}`)).data}async function pr(){const r=await M.get("/api/members");return console.log("API Response:",r.data),r.data.members||r.data}const br=async(r,a,t)=>{try{return(await M.post("/api/book/borrow",{qr_code:r,member_id:a,book_state:t})).data}catch(m){throw console.error("Error borrowing book:",m.response||m),m}},hr=async r=>{try{return(await M.post("/api/book/return",{qr_code:r})).data}catch(a){throw console.error("Error returning book:",a),a}};async function se(r,a){return(await X.get(`${G}/api/loans/history`,{params:{qr_code:r||"",show_all:a?"true":"false"}})).data}const gr=async(r,a,t,m="en")=>{var h,p;try{return(await M.post("/api/send-reminder",{loan_id:r,subject:a,loan_details:t,language:m})).data}catch(w){return console.error(`Error sending reminder for loan_id ${r}:`,w),{success:!1,error:((p=(h=w.response)==null?void 0:h.data)==null?void 0:p.error)||w.message||"Unknown error"}}},Re=async r=>{try{const a=await X.get(`${G}/api/reminders/last/${r}`),{sent_at:t}=a.data;return{sent_at:t}}catch(a){return console.error(`Error fetching last reminder for loan_id ${r}:`,a),null}},_r=({onScanSuccess:r,onScanError:a,onScanCancel:t})=>{const[m,h]=n.useState(!1),[p,w]=n.useState(""),[E,Q]=n.useState(0),A=async(x,f,y={},P)=>{try{const u=await x.scanFile(f,!0,y);return console.log(`Scan attempt ${P} succeeded:`,u),u}catch(u){console.log(`Scan attempt ${P} failed:`,u);const C=j(u);throw new Error(C)}},j=x=>{const f=(x==null?void 0:x.message)||"Unknown error";return f.includes("No barcode or QR code found")?"No QR code was detected in this image. Please try a clearer image with the QR code fully visible.":f.includes("BarCodeDetector not supported")?"Your browser doesn't support advanced QR scanning. Try a different browser or image.":f.includes("timeout")?"Scanning timed out. Try a smaller or clearer image.":f.includes("unable to parse")?"The QR code is damaged or unclear. Please try a different image with better lighting.":f.includes("file too large")?"The image is too large to process. Please try a smaller image.":`Couldn't scan the QR code: ${f}`},_=async x=>{const f=x.target.files[0];if(!f)return;console.log("File details:",f.name,f.type,f.size),console.log("File last modified:",new Date(f.lastModified).toISOString()),h(!0),w(""),Q(0);const y=new He("qr-reader"),P=/iPhone|iPad|iPod/i.test(navigator.userAgent),u=/^((?!chrome|android).)*safari/i.test(navigator.userAgent);console.log("Device detection - iOS:",P,"Safari:",u);try{const C=await B(f,P),R=P?[{formatsToSupport:[xe.QR_CODE],experimentalFeatures:{useBarCodeDetectorIfSupported:!1}},{formatsToSupport:[xe.QR_CODE],experimentalFeatures:{useBarCodeDetectorIfSupported:!0}},{}]:[{experimentalFeatures:{useBarCodeDetectorIfSupported:!0}},{formatsToSupport:[xe.QR_CODE]},{}];let N=!1,$=[];for(let k=0;k<R.length;k++)try{console.log(`Attempting scan with config ${k+1}:`,R[k]),Q(k+1);const L=C||f;console.log("Scanning file:",L.name,L.type,L.size);const I=await A(y,L,R[k],k+1);if(I){N=!0;try{await y.clear()}catch(T){console.warn("Error clearing scanner:",T)}r(I);break}}catch(L){console.log(`Config ${k+1} failed:`,L),$.push(L.message)}if(!N){const k=[...new Set($)],L=k.length>0?k[0]:"Failed to scan QR code. Please try a different image with better lighting and focus.";w(L)}}catch(C){console.error("Final error:",C);const R=j(C);w(R)}finally{try{await y.clear()}catch(C){console.error("Error clearing scanner:",C)}h(!1)}},B=async(x,f)=>x.type.startsWith("image/")&&x.size>1024*1024?new Promise((y,P)=>{try{const u=new Image,C=document.createElement("canvas"),R=C.getContext("2d");u.onload=()=>{let N=u.width,$=u.height;const k=1200;N>$&&N>k?($=Math.round($*k/N),N=k):$>k&&(N=Math.round(N*k/$),$=k),C.width=N,C.height=$,R.drawImage(u,0,0,N,$),C.toBlob(L=>{if(L){const I=new File([L],x.name,{type:"image/jpeg",lastModified:Date.now()});console.log("Resized image from",x.size,"to",I.size,"bytes"),y(I)}else console.warn("Failed to create blob from canvas"),y(null)},"image/jpeg",.95)},u.onerror=()=>{console.warn("Failed to load image for resizing"),y(null)},u.src=URL.createObjectURL(x)}catch(u){console.error("Error resizing image:",u),y(null)}}):null,S=()=>{w("")},q=()=>{a(new Error(p))};return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-lg max-w-md w-full",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Scan QR Code"}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{id:"qr-reader",style:{display:"none"}}),p?e.jsxs("div",{className:"text-center text-red-500 p-3 border border-red-200 rounded bg-red-50 mb-4",children:[e.jsx("p",{className:"font-medium mb-2",children:"Scan Failed"}),e.jsx("p",{className:"text-sm mb-3",children:p}),e.jsx("p",{className:"text-xs mb-3 text-gray-600",children:"Try using a well-lit image with the entire QR code visible and in focus"}),e.jsxs("div",{className:"flex space-x-2 mt-2",children:[e.jsx("button",{onClick:S,className:"flex-1 py-2 bg-blue-500 hover:bg-blue-600 text-white rounded text-sm",children:"Try Again"}),e.jsx("button",{onClick:q,className:"flex-1 py-2 bg-gray-200 hover:bg-gray-300 text-gray-800 rounded text-sm",children:"Cancel"})]})]}):e.jsx("div",{className:"flex flex-col items-center",children:e.jsxs("label",{className:"w-full flex flex-col items-center px-4 py-6 bg-coral text-blue rounded-lg shadow-lg tracking-wide uppercase border border-blue cursor-pointer hover:bg-blue hover:text-white",children:[e.jsx("span",{className:"mt-2 text-base leading-normal",children:"Select an image"}),e.jsx("input",{type:"file",className:"hidden",accept:"image/*",capture:"environment",onChange:_,disabled:m})]})}),m&&e.jsxs("div",{className:"text-center text-gray-600",children:["Processing image... ",E>0&&`(Attempt ${E})`]}),!p&&e.jsx("button",{onClick:t,className:"w-full mt-4 px-4 py-2 bg-gray-200 text-gray-800 rounded hover:bg-gray-300",children:"Cancel"})]})]})})},F={coral:"#F38181",teal:"#4ECAC7",yellow:"#FEC43C"};function xr(){const[r,a]=n.useState(""),[t,m]=n.useState([]),[h,p]=n.useState([]),[w,E]=n.useState(""),[Q,A]=n.useState(""),[j,_]=n.useState(null),[B,S]=n.useState(""),[q,x]=n.useState([]),[f,y]=n.useState(""),[P,u]=n.useState(null);n.useState([]);const[C,R]=n.useState([]),[N,$]=n.useState(!1),[k,L]=n.useState(!1),[I,T]=n.useState(!1),[W,V]=n.useState(!1),[z,H]=n.useState([]),[J,d]=n.useState(!1),{language:l,toggleLanguage:U,direction:b}=te(),c=ae(l),[D,Z]=n.useState(!0);n.useEffect(()=>{(async()=>{try{const[i,g,v]=await Promise.all([pr(),fe(),ye()]);m(i),p(g),x(v)}catch(i){console.error("Error loading initial data:",i)}})()},[]),n.useEffect(()=>{(async()=>{try{let i=null;r==="return"?i=f||null:r==="borrow"&&(i=Q||null);const g=await se(i,N),v=await Promise.all(g.map(async O=>{try{const re=await Re(O.id);return{...O,last_reminder_date:re?re.sent_at:null}}catch(re){return console.error(`Failed to fetch reminder for loan_id ${O.id}:`,re),{...O,last_reminder_date:null}}}));R(le(v))}catch(i){console.error("Error fetching loan history:",i),R([])}})()},[N,r,f,Q]),n.useEffect(()=>{_(null),A(""),u(null),y(""),S(""),E(null)},[r]);const Y=t.map(s=>({value:s.id,label:D?s.parent_name:s.kid_name,parentName:s.parent_name,childName:s.kid_name})),oe=h.map(s=>({value:s.qr_code,label:s.title})),me=s=>{if(!s.returned_at){const i=q.find(g=>g.id===s.book_id);i?(u(i),y(i.qr_code),_(i),S(i.delivery_status||""),window.scrollTo({top:0,behavior:"smooth"})):alert("Book not found in borrowed books.")}},pe=(s,i)=>{s.stopPropagation(),s.target.checked?H([...z,i]):H(z.filter(g=>g.id!==i.id))},be=async()=>{d(!0);try{const s=await Promise.all(z.map(async v=>{try{const O=await gr(v.id,"Book Return Reminder",{borrower_name:v.borrower_name,book_title:v.book_title,borrowed_at:v.borrowed_at},l);if(O.success){console.log(`Reminder sent successfully for loan_id: ${v.id}`);const re=new Date().toISOString().slice(0,19).replace("T"," ");R(ge=>ge.map(ee=>ee.id===v.id?{...ee,last_reminder_date:re}:ee));const ie=await Re(v.id);ie!=null&&ie.sent_at&&R(ge=>ge.map(ee=>ee.id===v.id?{...ee,last_reminder_date:ie.sent_at}:ee))}else console.error(`Failed to send reminder for loan_id: ${v.id} - ${O.error}`);return{success:O.success,loanId:v.id,error:O.error}}catch(O){return console.error(`Error sending reminder for loan_id ${v.id}:`,O),{success:!1,loanId:v.id,error:O.message}}})),i=s.filter(v=>v.success).length,g=s.filter(v=>!v.success);if(i>0&&alert(`Sent ${i} reminders successfully!`),g.length>0){const v=g.map(O=>`Loan ID: ${O.loanId} - ${O.error}`).join(`
`);alert(`Failed to send ${g.length} reminders.

${v}`)}H([]),V(!1)}catch(s){console.error("Failed to send reminders:",s),alert("Failed to send reminders. Please check your email service configuration.")}finally{d(!1)}},he=async s=>{const i=s.target.checked;$(i);try{let g=null;r==="return"?g=f||null:r==="borrow"&&(g=Q||null);const v=await se(g,i);R(le(v))}catch(g){console.error("Error fetching loan history:",g),R([])}},ne=async()=>{T(!0),L(!0)},o=async s=>{try{console.log("Handling scan result..."),L(!1),T(!0);const i=await mr(s);if(i)if(r==="borrow"?(A(s),_(i)):r==="return"&&(y(s),u(i),_(i),u(i)),S(i.delivery_status),i.loan_status==="borrowed"){const g=await se(s);if(g&&g.length>0){const v=g[0];alert(`The book "${i.title}" was borrowed by ${v.borrower_name} on ${v.borrowed_at}.`)}else alert(`The book "${i.title}" is marked as borrowed, but no loan history is available.`)}else alert(`The book "${i.title}" is available.`);else alert("Book not found for the given QR code.")}catch(i){console.error("Error processing scan result:",i),alert("An error occurred while processing the QR code.")}finally{T(!1)}},K=s=>{console.error("QR Scan Error:",s),L(!1),T(!1),alert("Failed to scan QR code. Please try again.")},$e=()=>{L(!1),T(!1)},Ae=async()=>{if(w&&j&&B)try{if((await br(j.qr_code,w.id,B)).message){alert("Book borrowed successfully!"),_(null),E(null),S("");const i=await fe(),g=await ye(),v=await se(null,N);p(i),x(g),R(le(v))}else alert("Error borrowing book.")}catch(s){console.error("Failed to borrow book:",s)}else alert("Please select a borrower, book, and book state.")},qe=async()=>{if(!f){alert("Please select a book to return.");return}try{if((await hr(f)).success){alert("Book returned successfully!"),u(null),y(""),_(null),S("");const i=await fe(),g=await ye(),v=await se(null,N);p(i),x(g),R(le(v))}else alert("Failed to return the book. Please try again.")}catch(s){console.error("Error returning book:",s),alert("An error occurred while returning the book. Please try again.")}},le=s=>s.sort((i,g)=>!i.return_date&&g.return_date?-1:i.return_date&&!g.return_date?1:new Date(g.loan_start_date)-new Date(i.loan_start_date));return e.jsxs("div",{className:"bg-white shadow-md rounded-lg p-6",children:[k&&e.jsx("div",{className:"scanner-modal",children:e.jsx(_r,{onScanSuccess:o,onScanError:K,onScanCancel:$e})}),e.jsxs("div",{className:"flex gap-4 mb-4",children:[e.jsx("div",{className:"absolute top-2 left-2",children:e.jsx("button",{className:"w-10 h-10 flex items-center justify-center rounded-full border border-teal-500 bg-white/50 text-teal-500 shadow-md",onClick:U,children:l==="en"?"HE":"EN"})}),e.jsx("button",{className:`flex-1 py-2 px-4 rounded ${r==="borrow"?"text-white":"text-gray-800"}`,style:{backgroundColor:r==="borrow"?F.coral:"transparent",borderColor:F.coral,borderWidth:"1px"},onClick:()=>a("borrow"),children:c.borrow}),e.jsx("button",{className:`flex-1 py-2 px-4 rounded ${r==="return"?"text-white":"text-gray-800"}`,style:{backgroundColor:r==="return"?F.coral:"transparent",borderColor:F.coral,borderWidth:"1px"},onClick:()=>a("return"),children:c.return})]}),r==="borrow"&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Be,{options:Y,placeholder:D?c.parent_name_placeholder:c.kid_name_placeholder,value:w?{value:w.id,label:D?w.parent_name:w.kid_name}:null,onChange:s=>{if(s){const i=t.find(g=>g.id===s.value||g.parent_name===s.label||g.kid_name===s.label);E(i||null)}else E(null)},isClearable:!0,styles:{control:s=>({...s,textAlign:l==="he"?"right":"left",direction:l==="he"?"rtl":"ltr",borderColor:F.coral,borderRadius:"4px",boxShadow:"none","&:hover":{borderColor:F.teal}})},className:"w-full flex-grow",classNamePrefix:"borrower-select"}),e.jsx("button",{onClick:()=>Z(!D),className:`relative inline-flex h-6 w-16 items-center rounded-full transition-colors duration-200 ease-in-out ${D?"bg-teal-600":"bg-gray-200"}`,children:e.jsx("span",{className:`inline-block h-4 w-4 transform rounded-full bg-gray-300 transition duration-200 ease-in-out ${D?"translate-x-6":"translate-x-1"}`})}),e.jsx("span",{className:"text-sm text-gray-600",children:D?c.parent_name_borrower:c.kid_name_borrower})]}),e.jsx(Be,{options:oe,placeholder:c.Select_Book,value:j?{value:j.qr_code,label:j.title}:null,onChange:s=>{const i=h.find(g=>g.qr_code===(s==null?void 0:s.value));_(i||null),A((s==null?void 0:s.value)||""),S((i==null?void 0:i.delivery_status)||"")},isClearable:!0,styles:{control:s=>({...s,textAlign:l==="he"?"right":"left",direction:l==="he"?"rtl":"ltr",borderColor:F.coral,borderRadius:"4px",boxShadow:"none","&:hover":{borderColor:F.teal}})},className:"w-full",classNamePrefix:"book-select"}),j&&e.jsxs("div",{className:`bg-gray-100 p-4 rounded mt-4 ${l==="he"?"rtl":""}`,children:[e.jsx("h3",{className:"font-bold text-lg",children:j.title}),e.jsxs("p",{className:"text-sm",children:[c.author,": ",j.author]}),e.jsxs("p",{className:"text-sm",children:[c.description,": ",j.description]}),e.jsxs("p",{className:"text-sm",children:[c.year_of_publication,": ",j.year_of_publication]}),e.jsxs("p",{className:"text-sm",children:[c.cover_type,": ",j.cover_type]}),e.jsxs("p",{className:"text-sm",children:[c.pages,": ",j.pages]}),e.jsxs("p",{className:"text-sm",children:[c.recommended_age,": ",j.recommended_age]}),e.jsxs("p",{className:"text-sm",children:[c.Select_Book_State,": ",j.book_condition]})]}),j&&e.jsxs("select",{className:"w-full p-2 border rounded mt-2",style:{borderColor:F.coral},onChange:s=>S(s.target.value),value:B,children:[e.jsx("option",{value:"",children:c.Select_Book_State}),e.jsx("option",{value:"כמו חדש",children:c.new}),e.jsx("option",{value:"מצויין - בלאי בלתי מורגש",children:c.good}),e.jsx("option",{value:"טוב - בלאי קל",children:c.worn})]}),e.jsxs("button",{className:"w-full flex items-center justify-center py-2 px-4 rounded text-white",style:{backgroundColor:F.coral},onClick:ne,children:[e.jsx(de,{className:"w-4 h-4 mr-2"}),c.ScanQR]}),e.jsx("button",{className:"w-full py-2 px-4 rounded text-white mt-2",style:{backgroundColor:F.coral},onClick:Ae,children:c.borrow}),e.jsx("div",{className:`loan-history-container ${l==="he"?"rtl":""}`,children:h.map(s=>e.jsxs("div",{className:`loan-history-card ${(j==null?void 0:j.qr_code)===s.qr_code?"active-loan":""} ${l==="he"?"rtl":""}`,onClick:()=>{_(s),A(s.qr_code),S(s.delivery_status||"")},style:{cursor:"pointer"},children:[e.jsx("div",{className:"loan-history-card-header",children:e.jsx("h3",{className:"loan-history-card-title",children:s.title})}),e.jsxs("div",{className:"loan-history-card-body",children:[e.jsxs("p",{className:"loan-history-card-detail",children:[c.author,": ",s.author]}),e.jsxs("p",{className:"loan-history-card-detail",children:[c.year_of_publication,": ",s.year_of_publication]}),e.jsxs("p",{className:"loan-history-card-detail",children:[c.pages,": ",s.pages]}),e.jsxs("p",{className:"loan-history-card-detail",children:[c.recommended_age,": ",s.recommended_age]})]})]},s.qr_code))})]}),r==="return"&&e.jsxs("div",{className:"mt-6",children:[e.jsx("div",{className:"mt-4",children:e.jsxs("select",{value:f||"",onChange:s=>{const i=s.target.value;y(i);const g=q.find(v=>v.qr_code===i);g&&(_(g),S(g.delivery_status||""))},className:"w-full p-2 border rounded",style:{borderColor:F.coral,textAlign:l==="he"?"right":"left",direction:l==="he"?"rtl":"ltr"},children:[e.jsx("option",{value:"",children:c.Select_Book}),q.map(s=>e.jsx("option",{value:s.qr_code,children:s.title},s.qr_code))]})}),e.jsxs("div",{className:"mt-4",children:[e.jsxs("button",{className:"w-full flex items-center justify-center py-2 px-4 rounded text-white",style:{backgroundColor:F.coral},onClick:ne,children:[e.jsx(de,{className:"w-4 h-4 mr-2"}),c.ScanQR]}),e.jsx("button",{className:"w-full py-2 px-4 rounded text-white mt-2",style:{backgroundColor:F.coral},onClick:qe,disabled:!P,children:c.return}),e.jsxs("button",{className:"w-full flex items-center justify-center py-2 px-4 rounded text-white mt-2",style:{backgroundColor:F.teal},onClick:()=>V(!W),children:[e.jsx(Qe,{className:"w-4 h-4 mr-2"}),c.SendReminders]})]}),e.jsx("div",{className:"flex items-center my-4",children:e.jsxs("label",{className:"flex items-center space-x-2",children:[e.jsx("button",{onClick:s=>he({target:{checked:!N}}),className:`relative inline-flex h-6 w-11 items-center rounded-full transition-colors duration-200 ease-in-out ${N?"bg-teal-600":"bg-gray-200"}`,children:e.jsx("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white transition duration-200 ease-in-out ${N?"translate-x-6":"translate-x-1"}`})}),e.jsx("span",{className:"text-sm text-gray-600",children:c.ShowAllLoans})]})}),W&&C.filter(s=>!s.returned_at).length>0&&e.jsxs("div",{className:"reminder-section bg-gray-100 p-4 rounded-lg mb-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("h3",{className:"text-lg font-semibold",children:c.SendReminders}),e.jsxs("label",{className:"flex items-center cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:z.length===C.filter(s=>!s.returned_at).length,onChange:s=>{if(s.target.checked){const i=C.filter(g=>!g.returned_at);H(i)}else H([])},className:"w-4 h-4 text-teal-500 border-gray-300 rounded focus:ring-teal-500 cursor-pointer"}),e.jsx("span",{className:"ml-2",children:c.select_all})]})]}),e.jsx("button",{className:"w-full py-2 px-4 rounded text-white",style:{backgroundColor:F.coral},onClick:be,disabled:z.length===0||J,children:J?c.sending_reminders:c.send_x_reminders.replace("{count}",z.length)})]}),C.length>0&&e.jsx("div",{className:`loan-history-container ${l==="he"?"rtl":""}`,children:C.map(s=>e.jsxs("div",{className:`loan-history-card ${s.returned_at?"":"active-loan"} ${l==="he"?"rtl":""}`,onClick:()=>r==="return"&&me(s),children:[e.jsxs("div",{className:"loan-history-card-header",children:[W&&!s.returned_at&&e.jsx("div",{onClick:i=>i.stopPropagation(),children:e.jsxs("label",{className:"custom-checkbox",children:[e.jsx("input",{type:"checkbox",checked:z.some(i=>i.id===s.id),onChange:i=>pe(i,s),className:"hidden-checkbox"}),e.jsx("span",{className:"checkbox-mark"})]})}),e.jsx("div",{className:"loan-history-card-title",children:s.book_title})]}),e.jsxs("div",{className:"loan-history-card-body",children:[e.jsxs("div",{className:"loan-history-card-detail",children:[c.borrowed_by," ",s.borrower_name]}),e.jsxs("div",{className:"loan-history-card-detail",children:[c.kid_name_borrower,": ",s.borrower_child||"N/A"]}),e.jsxs("div",{className:"loan-history-card-detail",children:[c.borrow_date,": ",s.borrowed_at]}),s.returned_at&&e.jsxs("div",{className:"loan-history-card-detail",children:[c.return_date,": ",s.returned_at]}),e.jsxs("div",{className:"loan-history-card-detail",children:[c.delivery_status,": ",s.book_state||"N/A"]}),s.last_reminder_date?e.jsxs("div",{className:"loan-history-card-detail",children:[c.last_reminder,": ",s.last_reminder_date]}):e.jsx("div",{className:"loan-history-card-detail no-reminder",children:c.no_reminder_sent})]})]},s.id))})]})]})}const ue=navigator.language||"en-US",fr=async(r="desc",a="title",t=!0)=>{try{const m=new URLSearchParams({order_by:r,sort_column:a,include_history:t.toString()});return(await M.get(`/api/generate_books_report?${m.toString()}`,{headers:{"Accept-Language":ue},responseType:"blob"})).data}catch(m){throw console.error("Error generating books report:",m),m}},yr=async(r="desc",a="title",t=!1)=>{try{const m=new URLSearchParams({order_by:r,sort_column:a,include_borrowed:t.toString()});return(await M.get(`/api/generate_inventory_report?${m.toString()}`,{headers:{"Accept-Language":ue},responseType:"blob"})).data}catch(m){throw console.error("Error generating inventory report:",m),m}},wr=async(r,a)=>{try{const t={start_qr:r,end_qr:a};return(await M.post("/api/reports/qr_codes",t,{headers:{"Accept-Language":ue},responseType:"blob"})).data}catch(t){throw console.error("Error generating QR codes report:",t),t}},vr=async()=>{try{return(await M.get("/api/qr_codes",{headers:{"Accept-Language":ue}})).data}catch(r){throw console.error("Error fetching QR codes:",r),r}},jr=async()=>{try{return(await M.get("/api/database/backup",{responseType:"blob"})).data}catch(r){throw console.error("Error backing up database:",r),r}},Nr=async r=>{try{const a=new FormData;return a.append("backup_file",r),(await M.post("/api/database/restore",a,{headers:{"Content-Type":"multipart/form-data"}})).data}catch(a){throw console.error("Error restoring database:",a),a}},kr=()=>{const{language:r,toggleLanguage:a}=te(),t=ae(r),[m,h]=n.useState(!1),[p,w]=n.useState(!0),[E,Q]=n.useState("desc"),[A,j]=n.useState(""),[_,B]=n.useState(""),[S,q]=n.useState(""),[x,f]=n.useState(""),[y,P]=n.useState(null),[u,C]=n.useState(!1),[R,N]=n.useState(!1),[$,k]=n.useState(null),[L,I]=n.useState({text:"",type:""}),[T,W]=n.useState(!1),V=()=>{W(b=>!b)},z={inventory:[{value:"title",label:t.book_title},{value:"author",label:t.author},{value:"id",label:t.id},{value:"loan_status",label:t.loan_status}],loans:[{value:"title",label:t.book_title},{value:"author",label:t.author},{value:"id",label:t.id}]};n.useEffect(()=>{_==="qr_codes"&&vr().then(b=>{const c=b.length;P(c),q("1"),f(String(c))}).catch(b=>{console.error("Error fetching QR codes:",b),P(0)})},[_]);const H=()=>{if(_==="qr_codes"){if(!S||!x)return!0;const b=parseInt(S,10),c=parseInt(x,10);return b>c||y!==null&&c>y}else return!A},J=async()=>{try{let b;_==="inventory"?b=await yr(E,A,p):_==="loans"?b=await fr(E,A,m):_==="qr_codes"&&(b=await wr(parseInt(S,10),parseInt(x,10)));const c=window.URL.createObjectURL(new Blob([b])),D=document.createElement("a");D.href=c,D.setAttribute("download",`${_}_report.${_==="qr_codes"?"pdf":"xlsx"}`),document.body.appendChild(D),D.click()}catch(b){console.error("Error generating report:",b),alert(t.error_generating_report)}},d=async()=>{try{C(!0),I({text:"",type:""});const b=await jr(),D=`library_backup_${new Date().toISOString().replace(/:/g,"-").split(".")[0]}.zip`,Z=window.URL.createObjectURL(new Blob([b])),Y=document.createElement("a");Y.href=Z,Y.setAttribute("download",D),document.body.appendChild(Y),Y.click(),Y.parentNode.removeChild(Y),window.URL.revokeObjectURL(Z),I({text:t.backup_success||"Database backup created successfully!",type:"success"})}catch(b){console.error("Backup failed:",b),I({text:t.backup_error||"Failed to create database backup.",type:"error"})}finally{C(!1)}},l=b=>{const c=b.target.files[0];c&&(k(c),I({text:"",type:""}))},U=async()=>{if(!$){I({text:t.no_file_selected||"Please select a backup file to restore.",type:"error"});return}if(window.confirm(t.confirm_restore||"Restoring the database will overwrite the current data. This action cannot be undone. Do you want to continue?"))try{N(!0),I({text:"",type:""});const c=await Nr($);I({text:c.message||t.restore_success||"Database restored successfully!",type:"success"}),k(null);const D=document.getElementById("restoreFileInput");D&&(D.value="")}catch(c){console.error("Restore failed:",c);let D=t.restore_error||"Failed to restore database.";c.response&&c.response.data&&c.response.data.error&&(D+=` ${c.response.data.error}`),I({text:D,type:"error"})}finally{N(!1)}};return e.jsxs("div",{className:`report-container ${r==="he"?"rtl":""}`,dir:r==="he"?"rtl":"ltr",children:[e.jsx("button",{onClick:a,className:"w-10 h-10 flex items-center justify-center rounded-full border border-teal-500 bg-white/50 text-teal-500 shadow-md absolute top-2 left-2",children:r==="en"?"HE":"EN"}),e.jsxs("div",{className:"p-4 bg-white rounded-lg shadow-md",children:[e.jsxs("div",{className:"flex items-center justify-center mb-4",children:[e.jsx(Pe,{className:"w-6 h-6 mr-2 text-teal-500"}),e.jsx("h2",{className:"text-xl font-bold text-gray-800",children:t.reports})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg border-gray-200 border-1",dir:r==="he"?"rtl":"ltr",children:[e.jsxs("h3",{className:"text-md font-semibold text-teal-600 mb-3 flex items-center",children:[e.jsx(Te,{className:`w-4 h-4 ${r==="he"?"ml-2":"mr-2"}`}),t.report_type_title||t.select_report_type]}),e.jsx("div",{className:"space-y-2",children:["inventory","loans","qr_codes"].map(b=>e.jsx("button",{onClick:()=>B(b),className:`w-full p-2 rounded-lg ${r==="he"?"text-right":"text-left"} text-sm ${_===b?"bg-teal-500 text-white shadow-md":"bg-white text-gray-700 hover:bg-gray-100 border border-gray-200"}`,children:b==="inventory"?t.inventory_report:b==="loans"?t.loans_report:t.qr_codes_report||"QR Codes PDF"},b))})]}),e.jsx("div",{className:`bg-gray-100 p-4 rounded-lg border border-gray-300 ${_?"":"opacity-50 pointer-events-none"}`,children:_&&e.jsxs("div",{className:"space-y-3",children:[e.jsxs("h3",{className:"text-md font-semibold text-teal-600 mb-3 flex items-center",children:[e.jsx(Fe,{className:`w-4 h-4 ${r==="he"?"ml-2":"mr-2"}`}),t.report_options]}),e.jsx("p",{className:`text-sm text-gray-600 ${r==="he"?"text-right":"text-left"}`,children:_==="inventory"?t.inventory_report_description||"This report generates an Excel file with current inventory details. You can sort the data by various fields and choose to include borrowed items.":_==="loans"?t.loans_report_description||"This report generates an Excel file of active loans. You can choose to include historical loans and sort by various fields.":t.qr_codes_description||"This report generates a printable PDF of QR codes arranged in a grid with cutting guides."}),_==="qr_codes"?e.jsxs("div",{className:"space-y-3",children:[y!==null&&e.jsx("p",{className:`text-sm text-purple-600 ${r==="he"?"text-right":"text-left"}`,children:t.qr_codes_available?t.qr_codes_available.replace("{count}",y):`There are ${y} QR codes available.`}),e.jsxs("div",{className:"flex flex-row items-end gap-4",children:[e.jsxs("div",{className:"flex flex-col flex-1",children:[e.jsx("label",{className:"text-xs",children:t.start_qr||"From QR ID"}),e.jsx("input",{type:"number",min:"1",value:S,onChange:b=>q(b.target.value),onBlur:()=>{const b=parseInt(S,10);(isNaN(b)||b<1)&&q("1")},className:"border rounded-md p-1 w-full"})]}),e.jsxs("div",{className:"flex flex-col flex-1",children:[e.jsx("label",{className:"text-xs",children:t.end_qr||"To QR ID"}),e.jsx("input",{type:"number",min:"1",max:y||void 0,value:x,onChange:b=>f(b.target.value),onBlur:()=>{const b=parseInt(x,10);isNaN(b)||b<1?f("1"):y!==null&&b>y&&f(String(y))},className:"border rounded-md p-1 w-full"})]})]}),parseInt(x,10)>y&&e.jsx("p",{className:"text-red-500 text-sm",children:t.end_qr_exceed_error?t.end_qr_exceed_error.replace("{qrCount}",y):`End QR ID cannot exceed ${y}.`}),S&&x&&parseInt(S,10)>parseInt(x,10)&&e.jsx("p",{className:"text-red-500 text-sm",children:t.from_qr_greater_error||"From QR ID cannot be greater than To QR ID."})]}):e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[_==="loans"&&e.jsx("div",{className:"flex items-center col-span-2",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{onClick:()=>h(!m),className:`relative inline-flex h-6 w-10 items-center rounded-full transition-colors duration-200 ease-in-out ${m?"bg-teal-600":"bg-gray-200"}`,children:e.jsx("span",{className:`absolute ${r==="he"?"right-1":"left-1"} top-1 h-4 w-4 transform rounded-full bg-white transition-transform duration-200 ease-in-out ${m?r==="he"?"-translate-x-5":"translate-x-5":"translate-x-0"}`})}),e.jsx("span",{className:"text-sm text-gray-600",children:t.include_history})]})}),_==="inventory"&&e.jsx("div",{className:"flex items-center col-span-2",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{onClick:()=>w(!p),className:`relative inline-flex h-6 w-11 items-center rounded-full transition-colors duration-200 ease-in-out ${p?"bg-teal-600":"bg-gray-200"}`,children:e.jsx("span",{className:`absolute ${r==="he"?"right-1":"left-1"} top-1 h-4 w-4 transform rounded-full bg-white transition-transform duration-200 ease-in-out ${p?r==="he"?"-translate-x-5":"translate-x-4":"translate-x-0"}`})}),e.jsx("span",{className:"text-sm text-gray-600",children:t.include_borrowed})]})}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{children:t.sort_by}),e.jsxs("select",{value:A,onChange:b=>j(b.target.value),className:"border rounded-md",children:[e.jsx("option",{value:"",children:t.select_field}),z[_].map(b=>e.jsx("option",{value:b.value,children:b.label},b.value))]})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{children:t.order}),e.jsxs("select",{value:E,onChange:b=>Q(b.target.value),className:"border rounded-md",children:[e.jsx("option",{value:"asc",children:t.ascending}),e.jsx("option",{value:"desc",children:t.descending})]})]})]}),e.jsxs("button",{onClick:J,disabled:H(),className:`w-full p-2 bg-teal-500 text-white rounded-md flex items-center justify-center ${r==="he"?"flex-row-reverse":""}`,children:[t.generate_report_button," ",e.jsx(_e,{className:`w-4 h-4 ${r==="he"?"ml-2":"mr-2"}`})]})]})})]}),e.jsxs("div",{className:"mt-8",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4 cursor-pointer bg-gray-200 p-3 rounded-md hover:bg-gray-300 transition",onClick:V,children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(ze,{className:"w-6 h-6 mr-2 text-teal-500"}),e.jsx("h2",{className:"text-xl font-bold text-gray-800",children:t.database_management||"Database Management"})]}),e.jsx("span",{className:"text-teal-500",children:T?"▲":"▼"})]}),T&&e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 bg-gray-50 p-4 rounded-lg border border-gray-200",children:[e.jsxs("div",{className:"p-4 rounded-lg border border-gray-200",children:[e.jsxs("h3",{className:"text-md font-semibold text-teal-600 mb-3 flex items-center",children:[e.jsx(_e,{className:"w-4 h-4 mr-2"}),t.backup_database||"Backup Database"]}),e.jsx("p",{className:"text-sm text-gray-600 mb-4",children:t.backup_description||"Create a backup of the database."}),e.jsxs("button",{onClick:d,disabled:u,className:"w-full p-2 bg-teal-500 text-white rounded-md flex items-center justify-center",children:[u?"Creating Backup...":"Download Database Backup",e.jsx(_e,{className:"w-4 h-4 ml-2"})]})]}),e.jsxs("div",{className:"p-4 rounded-lg border border-gray-200",children:[e.jsxs("h3",{className:"text-md font-semibold text-teal-600 mb-3 flex items-center",children:[e.jsx(Ne,{className:"w-4 h-4 mr-2"}),t.restore_database||"Restore Database"]}),e.jsx("p",{className:"text-sm text-gray-600 mb-4",children:t.restore_description||"Restore the database from a backup file."}),e.jsx("input",{type:"file",accept:".zip,.db",onChange:l,className:"border rounded-md p-1 text-sm w-full"}),e.jsxs("button",{onClick:U,disabled:!$||R,className:"w-full p-2 bg-teal-500 text-white rounded-md flex items-center justify-center mt-2",children:[R?"Restoring Database...":"Restore Database",e.jsx(Ne,{className:"w-4 h-4 ml-2"})]})]})]})]})]})]})},Sr="/icm_lib/assets/banner_nobg-ldt_Oxdo.png";function Cr(){const[r,a]=n.useState(!1),t=()=>{a(!0)},m=()=>{a(!1)};return e.jsx(Ve,{children:r?e.jsx(Br,{onLogout:m}):e.jsx(rr,{onLogin:t})})}function Br({onLogout:r}){const{language:a}=te(),t=ae(a),m=a==="he",h=m?[{value:"reports",icon:e.jsx(ke,{className:"w-4 h-4 mr-2"}),label:t.reports},{value:"members",icon:e.jsx(Se,{className:"w-4 h-4 mr-2"}),label:t.members},{value:"loans",icon:e.jsx(de,{className:"w-4 h-4 mr-2"}),label:t.loans},{value:"inventory",icon:e.jsx(Ce,{className:"w-4 h-4 mr-2"}),label:t.books}]:[{value:"inventory",icon:e.jsx(Ce,{className:"w-4 h-4 mr-2"}),label:t.books},{value:"loans",icon:e.jsx(de,{className:"w-4 h-4 mr-2"}),label:t.loans},{value:"members",icon:e.jsx(Se,{className:"w-4 h-4 mr-2"}),label:t.members},{value:"reports",icon:e.jsx(ke,{className:"w-4 h-4 mr-2"}),label:t.reports}];return e.jsxs("div",{className:`app-container min-h-screen bg-blend-screen max-w-md mx-auto ${m?"rtl":"ltr"}`,children:[e.jsxs("header",{className:"bg-white drop-shadow-2xl rounded-full",children:[e.jsxs("div",{className:"banner-container",children:[e.jsx("img",{src:Sr,alt:"ICM Library Logo",className:"banner-logo"}),e.jsx("div",{className:"banner-text",children:e.jsx("p",{className:"text-sm text-gray-600",children:t.app_title})})]}),e.jsx("button",{className:"logout-button",onClick:r,title:"Logout",children:e.jsx(Oe,{className:"logout-icon"})})]}),e.jsx("div",{className:"max-w-md mx-auto",children:e.jsxs(Ue,{defaultValue:"inventory",className:"tabs-content",children:[e.jsx(Ye,{className:"tabs-list w-full shadow-md rounded-lg grid grid-cols-4",children:h.map(p=>e.jsxs(Ke,{value:p.value,className:`tab-item 
                                flex items-center justify-center 
                                text-gray-800 py-2 rounded-t-lg hover:bg-gray-100 
                                ${p.value==="inventory"&&"data-[state=active]:bg-teal-500 data-[state=active]:!text-white"}
                                ${p.value==="loans"&&"data-[state=active]:bg-red-500 data-[state=active]:!text-white"}
                                ${p.value==="members"&&"data-[state=active]:bg-[#FDB813] data-[state=active]:!text-white"}
                                ${p.value==="reports"&&"data-[state=active]:bg-purple-500 data-[state=active]:!text-white"}`,children:[p.icon,p.label]},p.value))}),e.jsx("div",{style:{height:"15px"}}),e.jsx(ce,{value:"inventory",children:e.jsx(dr,{})}),e.jsx(ce,{value:"loans",children:e.jsx(xr,{})}),e.jsx(ce,{value:"members",children:e.jsx(ur,{})}),e.jsx(ce,{value:"reports",children:e.jsx(kr,{})})]})})]})}Ie(document.getElementById("root")).render(e.jsx(n.StrictMode,{children:e.jsx(Cr,{})}));
