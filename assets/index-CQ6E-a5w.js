import{r as n,j as e}from"./react-Dl5khTFu.js";import{c as Ce}from"./react-dom-CaK7Gm4w.js";import{a as T}from"./axios-upsvKRUO.js";import{S as fe,C as Be,a as Le,T as Ee,Q as xe,M as Ae,b as Re,F as $e,c as qe,D as Me,B as Pe,U as De,d as Ie}from"./lucide-react-Qup7eZgG.js";import{S as ye}from"./react-select-DNjq-Jfl.js";import{H as Te}from"./html5-qrcode-CAPQZwmQ.js";import{T as Fe,a as Qe,b as ie,c as de}from"./@radix-ui-FaNOjPFF.js";import"./hoist-non-react-statics-DUIF_pJT.js";import"./react-is-8JwjhRSi.js";import"./scheduler-CylivXx-.js";import"./@babel-DeGXz7kM.js";import"./@emotion-C1jRIs2C.js";import"./stylis-YPZU7XtI.js";import"./@floating-ui-DZ2V_EUC.js";import"./use-isomorphic-layout-effect-Do5Xa1W_.js";import"./memoize-one-DxrTgWdQ.js";(function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const u of document.querySelectorAll('link[rel="modulepreload"]'))d(u);new MutationObserver(u=>{for(const h of u)if(h.type==="childList")for(const f of h.addedNodes)f.tagName==="LINK"&&f.rel==="modulepreload"&&d(f)}).observe(document,{childList:!0,subtree:!0});function a(u){const h={};return u.integrity&&(h.integrity=u.integrity),u.referrerPolicy&&(h.referrerPolicy=u.referrerPolicy),u.crossOrigin==="use-credentials"?h.credentials="include":u.crossOrigin==="anonymous"?h.credentials="omit":h.credentials="same-origin",h}function d(u){if(u.ep)return;u.ep=!0;const h=a(u);fetch(u.href,h)}})();const ve="/icm_lib/assets/img-Dm6ee46N.png",R="http://localhost:5000",He=({onLogin:r})=>{const[s,a]=n.useState(""),[d,u]=n.useState(""),[h,f]=n.useState(""),j=async v=>{v.preventDefault();try{const w=await T.post(`${R}/api/login`,{username:s,password:d});w.status===200&&(localStorage.setItem("authToken",w.data.token),r())}catch{f("Invalid username or password.")}};return e.jsx("div",{className:"flex items-center justify-center min-h-screen bg-gray-100",children:e.jsxs("form",{onSubmit:j,className:"bg-white p-6 rounded shadow-md w-80",children:[e.jsx("img",{src:ve,alt:"ICM Library Logo",className:"max-h-16 sm:max-h-20 mx-auto mb-4"}),e.jsx("h1",{className:"text-xl font-semibold mb-4",children:"Login"}),h&&e.jsx("div",{className:"text-red-500 text-sm mb-2",children:h}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-gray-700 text-sm mb-2",children:"Username"}),e.jsx("input",{type:"text",className:"w-full p-2 border rounded",value:s,onChange:v=>a(v.target.value)})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-gray-700 text-sm mb-2",children:"Password"}),e.jsx("input",{type:"password",className:"w-full p-2 border rounded",value:d,onChange:v=>u(v.target.value)})]}),e.jsx("button",{type:"submit",className:"w-full bg-blue-500 text-white py-2 rounded",children:"Login"})]})})},$=T.create({baseURL:R});$.interceptors.request.use(r=>{const s=localStorage.getItem("authToken");return console.log("Token in localStorage:",s),s&&(r.headers.Authorization=s),r},r=>Promise.reject(r));$.interceptors.response.use(r=>r,r=>(r.response&&r.response.status===403&&(localStorage.removeItem("authToken"),alert("Session expired. Please log in again."),window.location.reload()),Promise.reject(r)));const Ue=async r=>{try{return(await $.post("/api/members",r)).data}catch{throw new Error("Failed to add member.")}},je=async()=>{try{return(await $.get("/api/members")).data}catch(r){throw console.error("Error fetching members:",r),r}},Oe=async(r,s)=>{try{return(await $.put(`/api/members/${r}`,s)).data}catch(a){throw console.error("Error updating member:",a),a}},ze=async r=>{try{return(await $.delete(`/api/members/${r}`)).data}catch(s){throw console.error("Error deleting member:",s),s}},Ke=async(r="desc")=>{try{return(await T.get(`${R}/api/books?order_by=${r}`)).data}catch(s){throw console.error("Error fetching books:",s),s}},Ye=async r=>{try{return(await $.post("/api/books",r,{headers:{"Content-Type":"application/json"}})).data}catch(s){throw console.error("Error adding book:",s),new Error("Failed to add book.")}},Ge=async r=>{try{const s=await T.get(`${R}/api/qr_codes/${r}`,{responseType:"blob"}),a=window.URL.createObjectURL(new Blob([s.data])),d=document.createElement("a");d.href=a,d.setAttribute("download",r),document.body.appendChild(d),d.click(),d.remove()}catch(s){throw console.error("Error downloading QR code:",s),s}},Ve=async(r,s)=>{try{return(await $.put(`${R}/api/books/${r}`,s)).data}catch(a){throw console.error("Error updating book:",a),a}},Ne=n.createContext(),We=({children:r})=>{const[s,a]=n.useState("he"),d=h=>h==="he"?"rtl":"ltr",u=()=>{a(h=>h==="en"?"he":"en")};return e.jsx(Ne.Provider,{value:{language:s,setLanguage:a,toggleLanguage:u,direction:d(s)},children:r})},J=()=>n.useContext(Ne),Je={by:"by",app_title:"The Library of the Israeli Community of Madrid",title:"Book Title",author:"Author",description:"Description",year_of_publication:"Year of Publication",cover_type:"Cover Type",pages:"Pages",borrowing_child:"Borrowing Child's Name",borrowed_by:"Borrowed By",borrower:"Borrower",borrow:"Borrow Book",delivery_status:"Delivery Status",delivering_parent:"Delivering Parent",recommended_age:"Recommended Age",borrow_date:"Borrow Date",return_date:"Return Date",NotReturned:"Not Returned",add_book_label:"Add New Book",books:"Books",members:"Members",loans:"Loans",ShowAllLoans:"Show History",Hide_Details:"Hide Details",More_Details:"More Details",loan_status:"Availability",sort_by:"Sort By",ascending:"Ascending",descending:"Descending",Hide_Add_Book:"Hide Add Book",Add_Book:"Add Book",return:"Return Book",Select_Book:"Select Book",Select_Book_State:"Select Book State",ScanQR:"Scan QR Code",download_qr_code:"Download QR Code",SendReminders:"Send Reminders",last_reminder:"last reminder at",sending_reminders:"Sending...",send_x_reminders:"Send {count} Reminders",error_generating_report:"Failed to generate report. Please try again.",reports:"Reports",generate_report_button:"Generate report",select_borrower:"Select Borrower",add_member_button:"Add Member",edit_member:"Edit Member",delete_member:"Delete Member",close_add_member_button:"Close Add Member",add_member_form_title:"Add New Member",search_placeholder:"Search members by name",members_list_title:"Library Members",no_members_found:"No members found",select_all:"Select All",parent_name_placeholder:"Parent's Name",kid_name_placeholder:"Kid's Name",email_placeholder:"Email Address",error_parent_name_required:"Parent's name is required.",error_kid_name_required:"Kid's name is required.",error_email_required:"Email address is required.",error_email_invalid:"Invalid email address.",email_missing_warning:"No email provided - notifications will not be sent to this member",confirm_delete_member:"Are you sure you want to delete this member?",no_email_provided:"No email provided",success_member_added:"Member added successfully!",success_member_updated:"Member updates successfully!",success_member_deleted:"Member deleted successfully!",parent_name_label:"Parent Name",kid_name_label:"Child Name",email_label:"Email",inventory_list_title:"Library Inventory",add_book_button:"Add Book",close_add_book_button:"Close Add Book",search_books_placeholder:"Search books by title",no_books_found:"No books found",placeholder_book_title:"Enter Book Title",placeholder_book_author:"Enter Author Name",placeholder_book_description:"Enter Description",placeholder_book_year:"Enter Year of Publication",placeholder_book_pages:"Enter Number of Pages",placeholder_book_recommended_age:"Enter Recommended Age",select_condition:"Select Condition",select_loan_status:"Select loan status",select_parent:"Select Parent",select_cover_type:"format",soft_cover:"Soft Cover",hard_cover:"Hard Cover",rigid_pages:"Rigid Pages",battery_book:"Book with Battery",new:"Like New",good:"Excellent - No noticeable wear",worn:"Good - Minor wear",available:"Available",borrowed:"Borrowed",error_book_title_required:"Book title is required.",error_book_author_required:"Author name is required.",error_book_description_required:"Description is required.",error_book_year_required:"Year of publication is required.",error_book_pages_required:"Number of pages is required.",inventory_report:"Inventory Report",loans_report:"Loans Report",select_report_type:"Select Report Type",report_options:"Report Options",select_field:"Select Field",book_title:"Book Title",id:"ID",order:"Order",include_history:"Include Historical Loans",include_borrowed:"Include Currently Borrowed Books",update_book_button:"Update book information",edit_book:"Edit book information"},Xe={by:"על ידי",app_title:"ספריית הקהילה הישראלית במדריד",title:"שם הספר",author:"שם המחבר",description:"תיאור",year_of_publication:"שנת הוצאה",cover_type:"סוג כריכה",pages:"עמודים",borrowing_child:"שם הילד המשאיל",borrowed_by:"הושאל על ידי",borrower:"המשאיל",borrow:"השאל ספר",delivery_status:"מצב מסירה",delivering_parent:"שם ההורה המוסר",recommended_age:"גיל מומלץ",borrow_date:"תאריך השאלה",return_date:"תאריך החזרה",NotReturned:"לא הוחזר",add_book_label:"הוסף ספר חדש",books:"ספרים",members:"חברים",loans:"השאלות",ShowAllLoans:"הצג היסטוריה",Hide_Details:"הסתר פרטים",More_Details:"עוד פרטים",loan_status:"זמינות",sort_by:"סדר",ascending:"עולה",descending:"יורד",Hide_Add_Book:"הסתר הוספת ספר",Add_Book:"הוסף ספר",return:"החזר ספר",Select_Book:"בחר ספר",Select_Book_State:"מצב הספר",ScanQR:"סרוק ברקוד",download_qr_code:"הורד ברקוד",SendReminders:"שלח תזכורת",last_reminder:"תזכורת אחרונה ב",sending_reminders:"שולח...",send_x_reminders:"שלח {count} תזכורות",error_generating_report:"הפקת הדוח נכשלה, נסה שנית בבקשה.",reports:"דוחות",generate_report_button:"הפק דוח",select_borrower:"בחר משאיל",add_member_button:"הוסף חבר",edit_member:"ערוך",delete_member:"מחק חבר",close_add_member_button:"סגור הוספת חבר",add_member_form_title:"הוספת חבר חדש",search_placeholder:"חפש חברים לפי שם",members_list_title:"חברי הספרייה",no_members_found:"לא נמצאו חברים",select_all:"בחר הכל",parent_name_placeholder:"שם ההורה",kid_name_placeholder:"שם הילד",email_placeholder:"כתובת אימייל",error_parent_name_required:"נדרש שם הורה.",error_kid_name_required:"נדרש שם ילד.",error_email_required:"נדרשת כתובת אימייל.",error_email_invalid:"כתובת אימייל לא תקינה.",email_missing_warning:"לא סופק אימייל - לא יישלחו התראות לחבר זה",no_email_provided:"לא סופק אימייל",success_member_added:"החבר נוסף בהצלחה!",success_member_updated:"החבר עודכן בהצלחה!",success_member_deleted:"חבר נמחק בהצלחה!",parent_name_label:"שם ההורה",kid_name_label:"שם הילד",email_label:"אימייל",inventory_list_title:"מלאי הספרייה",add_book_button:"הוסף ספר",close_add_book_button:"סגור הוספת ספר",search_books_placeholder:"חפש ספרים לפי שם",no_books_found:"לא נמצאו ספרים",placeholder_book_title:"הכנס שם הספר",placeholder_book_author:"הכנס שם המחבר",placeholder_book_description:"הכנס תיאור",placeholder_book_year:"הכנס שנת הוצאה",placeholder_book_pages:"הכנס מספר עמודים",placeholder_book_recommended_age:"הכנס גיל מומלץ",select_condition:"מצב מסירה",select_loan_status:"זמינות",select_parent:"שם ההורה",select_cover_type:"פורמט",soft_cover:"כריכה רכה",hard_cover:"כריכה קשה",rigid_pages:"עמודים קשיחים",battery_book:"ספר עם בטריה",new:"כמו חדש",good:"מצויין - בלאי בלתי מורגש",worn:"טוב - בלאי קל",available:"זמין",borrowed:"מושאל",error_book_title_required:"נדרש שם ספר.",error_book_author_required:"נדרש שם מחבר.",error_book_description_required:"נדרש תיאור.",error_book_year_required:"נדרשת שנת הוצאה.",error_book_pages_required:"נדרש מספר עמודים.",confirm_delete_member:"האם אתה בטוח שברצונך למחוק חבר זה?",inventory_report:"דוח מלאי",loans_report:"דוח השאלות",select_report_type:"בחר סוג דוח",report_options:"אפשרויות דוח",select_field:"בחר שדה",book_title:"כותרת הספר",id:"מזהה",order:"סדר",include_history:"כלול היסטורית השאלות",include_borrowed:"כלול ספרים מושאלים",update_book_button:"עדכון ספר",edit_book:"ערוך ספר"},X=r=>r==="he"?Xe:Je,Ze=(r,s)=>({"כריכה רכה":s.soft_cover,"כריכה קשה":s.hard_cover,"עמודים קשיחים":s.rigid_pages,"ספר עם בטריה":s.battery_book})[r]||"N/A",er=(r,s)=>({"כמו חדש":s.new,"מצויין - בלאי בלתי מורגש":s.good,"טוב - בלאי קל":s.worn})[r]||"N/A",rr=()=>{const[r,s]=n.useState([]),[a,d]=n.useState("desc"),[u,h]=n.useState(""),[f,j]=n.useState(""),[v,w]=n.useState(""),[m,x]=n.useState(""),[N,k]=n.useState(""),[q,_]=n.useState(""),[L,S]=n.useState(""),[z,y]=n.useState(""),[M]=n.useState("available"),[E,P]=n.useState(""),[Y,G]=n.useState([]),[F,H]=n.useState(!1),[D,c]=n.useState(""),[A,Q]=n.useState({}),{language:U,toggleLanguage:Z,direction:ee}=J(),i=X(U),[V,ce]=n.useState(null),[b,re]=n.useState(""),te=[{value:"כריכה רכה",label:i.soft_cover},{value:"כריכה קשה",label:i.hard_cover},{value:"עמודים קשיחים",label:i.rigid_pages},{value:"ספר עם בטריה",label:i.battery_book}],oe=[{value:"כמו חדש",label:i.new},{value:"מצויין - בלאי בלתי מורגש",label:i.good},{value:"טוב - בלאי קל",label:i.worn}];n.useEffect(()=>{se(),me()},[a]);const se=async()=>{try{const t=await Ke(a);Array.isArray(t)?s(t):(console.error("Unexpected response format:",t),s([]))}catch(t){console.error("Failed to load books:",t),s([])}},me=async()=>{try{const t=await je();G(t)}catch(t){console.error("Error fetching members:",t)}},ue=async t=>{t.preventDefault();try{const I={title:u,author:f,description:v,year_of_publication:m,pages:N,cover_type:q,book_condition:L,recommended_age:z,loan_status:M,delivering_parent:E};V?await Ve(V,I):await Ye(I),ce(null),re(""),h(""),j(""),w(""),x(""),k(""),_(te[0].value),S(oe[0].value),P(""),H(!1),await se()}catch(I){console.error("Error saving book:",I)}},ae=t=>{H(!0),ce(t.id),re(t.qr_code),h(t.title),j(t.author||""),w(t.description||""),x(t.year_of_publication||""),k(t.pages||""),_(t.cover_type||""),S(t.book_condition||""),y(t.recommended_age||""),P(t.delivering_parent||"")},he=t=>{Q(I=>({...I,[t]:!I[t]}))},pe=t=>{Ge(t).then(()=>console.log("QR Code downloaded successfully")).catch(I=>console.error("Failed to download QR Code:",I))};return e.jsxs("div",{className:"w-full max-w-md mx-auto",children:[e.jsx("button",{className:"w-12 h-12 flex items-center justify-center rounded-full border border-teal-500 bg-white text-teal-500 shadow-md absolute top-4 left-4",onClick:Z,children:U==="en"?"HE":"EN"}),e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("input",{id:"search_by_name",type:"text",placeholder:i.search_books_placeholder,value:D,onChange:t=>c(t.target.value),className:"flex-1 mr-4 border border-gray-300 rounded-md py-2 px-4"}),e.jsxs("div",{className:"sorting-container",children:[e.jsxs("label",{htmlFor:"orderBy",className:"mr-2",children:[":",i.sort_by]}),e.jsxs("select",{id:"orderBy",value:a,onChange:t=>d(t.target.value),className:"border rounded p-1",children:[e.jsx("option",{value:"desc",children:i.descending}),e.jsx("option",{value:"asc",children:i.ascending})]})]})]}),e.jsx("button",{onClick:()=>H(!F),className:"w-full bg-blue-500 text-white font-semibold py-2 rounded-md hover:bg-blue-600 transition mb-4",children:F?`- ${i.close_add_book_button}`:`+ ${i.add_book_button}`}),F&&e.jsxs("form",{onSubmit:ue,className:"mb-4",children:[e.jsx("input",{type:"text",value:u,onChange:t=>h(t.target.value),placeholder:i.placeholder_book_title,className:"input mb-2 w-full border border-gray-300 rounded-md py-2 px-4"}),e.jsx("input",{type:"text",value:f,onChange:t=>j(t.target.value),placeholder:i.placeholder_book_author,className:"input mb-2 w-full border border-gray-300 rounded-md py-2 px-4"}),e.jsx("textarea",{value:v,onChange:t=>w(t.target.value),onInput:t=>{t.target.style.height="auto",t.target.style.height=`${t.target.scrollHeight}px`},placeholder:i.placeholder_book_description,className:"input mb-2 w-full border border-gray-300 rounded-md py-2 px-4"}),e.jsx("input",{type:"number",value:m,onChange:t=>x(t.target.value),placeholder:i.placeholder_book_year,className:"input mb-2 w-full border border-gray-300 rounded-md py-2 px-4"}),e.jsxs("select",{value:q,onChange:t=>_(t.target.value),className:"input mb-2 w-full border border-gray-300 rounded-md py-2 px-4",children:[e.jsx("option",{value:"",children:i.select_cover_type}),te.map(t=>e.jsx("option",{value:t.value,children:t.label},t.value))]}),e.jsx("input",{type:"number",value:N,onChange:t=>k(t.target.value),placeholder:i.placeholder_book_pages,className:"input mb-2 w-full border border-gray-300 rounded-md py-2 px-4"}),e.jsx("input",{type:"number",value:z,onChange:t=>y(t.target.value),placeholder:i.placeholder_book_recommended_age,className:"input mb-2 w-full border border-gray-300 rounded-md py-2 px-4"}),e.jsxs("select",{value:L,onChange:t=>S(t.target.value),className:"input mb-2 w-full border border-gray-300 rounded-md py-2 px-4",children:[e.jsx("option",{value:"",children:i.select_condition}),oe.map(t=>e.jsx("option",{value:t.value,children:t.label},t.value))]}),e.jsxs("select",{value:E,onChange:t=>P(t.target.value),className:"input mb-2 w-full border border-gray-300 rounded-md py-2 px-4",children:[e.jsx("option",{value:"",children:i.select_parent}),Y.map(t=>e.jsx("option",{value:t.parent_name,children:t.parent_name},t.id))]}),e.jsx("button",{type:"submit",className:"w-full bg-green-500 text-white font-semibold py-2 rounded-md hover:bg-green-600 transition",children:V?i.update_book_button:i.add_book_button})]}),e.jsx("div",{dir:ee,children:e.jsx("div",{className:"overflow-y-auto max-h-screen border-t pt-4",children:r.filter(t=>t.title.toLowerCase().includes(D.toLowerCase())||t.author.toLowerCase().includes(D.toLowerCase())).map(t=>e.jsxs("div",{className:"bg-gray-50 shadow-sm rounded-lg p-4 mb-2 relative",children:[e.jsxs("div",{className:"mb-12",children:[e.jsx("h2",{className:"font-bold text-gray-800",children:t.title}),e.jsx("p",{className:"text-sm text-gray-500",children:t.author}),e.jsxs("p",{className:"text-sm mb-4",children:[e.jsx("span",{className:t.loan_status==="available"?"text-green-500":"text-red-500",children:t.loan_status==="borrowed"?i.borrowed:i.available}),t.loan_status==="borrowed"&&e.jsxs("span",{children:[" ",i.by," ",t.borrowing_child]})]}),e.jsx("button",{onClick:()=>pe(`${t.qr_code}.png`),className:"text-blue-600 text-sm px-3 py-1 rounded-md border border-blue-600 hover:bg-blue-50 transition-colors duration-200",children:i.download_qr_code})]}),e.jsxs("div",{className:"absolute bottom-4 inset-x-4 flex justify-between items-center",children:[e.jsx("button",{onClick:()=>ae(t),className:"p-2 text-gray-600 hover:text-emerald-600 transition-colors duration-200","aria-label":i.edit_book,children:e.jsx(fe,{size:20})}),e.jsx("button",{onClick:()=>he(t.qr_code),className:"flex items-center gap-1 text-gray-600 hover:text-indigo-600 transition-colors duration-200",children:A[t.qr_code]?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"text-sm",children:i.Hide_Details}),e.jsx(Be,{size:20})]}):e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"text-sm",children:i.More_Details}),e.jsx(Le,{size:20})]})}),e.jsx("div",{className:"w-8","aria-hidden":"true"})]}),A[t.qr_code]&&e.jsxs("div",{className:"mt-8 mb-8 text-gray-600 bg-white p-4 rounded-md border border-gray-100",children:[e.jsxs("p",{children:[e.jsxs("strong",{children:[i.description,":"]})," ",t.description||"N/A"]}),e.jsxs("p",{children:[e.jsxs("strong",{children:[i.year_of_publication,":"]})," ",t.year_of_publication||"N/A"]}),e.jsxs("p",{children:[e.jsxs("strong",{children:[i.cover_type,":"]})," ",Ze(t.cover_type,i)]}),e.jsxs("p",{children:[e.jsxs("strong",{children:[i.pages,":"]})," ",t.pages||"N/A"]}),e.jsxs("p",{children:[e.jsxs("strong",{children:[i.recommended_age,":"]})," ",t.recommended_age||"N/A"]}),e.jsxs("p",{children:[e.jsxs("strong",{children:[i.select_condition,":"]})," ",er(t.book_condition,i)]}),e.jsxs("p",{children:[e.jsxs("strong",{children:[i.delivering_parent,":"]})," ",t.delivering_parent||"N/A"]})]})]},t.qr_code))})})]})};function tr(){const[r,s]=n.useState([]),[a,d]=n.useState(""),[u,h]=n.useState(""),[f,j]=n.useState(""),[v,w]=n.useState(!1),[m,x]=n.useState(""),[N,k]=n.useState({}),[q,_]=n.useState(""),{language:L,toggleLanguage:S,direction:z}=J(),y=X(L),[M,E]=n.useState(null);n.useState({});const P=()=>{const c={};return a.trim()||(c.parentName=y.error_parent_name_required),u.trim()||(c.kidName=y.error_kid_name_required),f.trim()&&!/\S+@\S+\.\S+/.test(f)&&(c.email=y.error_email_invalid),k(c),Object.keys(c).length===0},Y=async c=>{if(c.preventDefault(),!!P()){f.trim()||alert(y.email_missing_warning);try{const A={parent_name:a,kid_name:u,email:f};M?await Oe(M,A):await Ue(A),E(null),d(""),h(""),j(""),k({}),_(M?y.success_member_updated:y.success_member_added),await H()}catch(A){console.error("Error saving member:",A),_("")}}},G=async c=>{if(window.confirm(y.confirm_delete_member))try{await ze(c),_(y.success_member_deleted),await H()}catch(A){console.error("Error deleting member:",A),alert("Cannot delete member: they have open loans.")}},F=c=>{E(c.id),d(c.parent_name),h(c.kid_name),j(c.email),w(!0)},H=async()=>{try{const c=await je();Array.isArray(c)?s(c):(console.error("Unexpected response format:",c),s([]))}catch(c){console.error("Failed to load members:",c),s([])}};n.useEffect(()=>{H()},[]);const D=Array.isArray(r)?r.filter(c=>c.parent_name.toLowerCase().includes(m.toLowerCase())||c.kid_name.toLowerCase().includes(m.toLowerCase())):[];return e.jsxs("div",{className:"w-full max-w-md mx-auto",children:[e.jsx("button",{className:"w-12 h-12 flex items-center justify-center rounded-full border border-teal-500 bg-white text-teal-500 shadow-md absolute top-4 left-4",onClick:S,children:L==="en"?"HE":"EN"}),e.jsx("h1",{className:"text-xl font-semibold mb-4",children:y.members_list_title}),e.jsx("button",{onClick:()=>w(!v),className:"w-full bg-blue-500 text-white font-semibold py-2 rounded-md hover:bg-blue-600 transition mb-4",children:v?`- ${y.close_add_member_button}`:`+ ${y.add_member_button}`}),v&&e.jsxs("form",{onSubmit:Y,className:"mb-4",children:[e.jsx("input",{type:"text",placeholder:y.parent_name_placeholder,value:a,onChange:c=>d(c.target.value),className:"input mb-2 w-full border border-gray-300 rounded-md py-2 px-4"}),N.parentName&&e.jsx("p",{className:"text-red-500 text-sm",children:N.parentName}),e.jsx("input",{type:"text",placeholder:y.kid_name_placeholder,value:u,onChange:c=>h(c.target.value),className:"input mb-2 w-full border border-gray-300 rounded-md py-2 px-4"}),N.kidName&&e.jsx("p",{className:"text-red-500 text-sm",children:N.kidName}),e.jsx("input",{type:"email",placeholder:y.email_placeholder,value:f,onChange:c=>j(c.target.value),className:"input mb-2 w-full border border-gray-300 rounded-md py-2 px-4"}),N.email&&e.jsx("p",{className:"text-red-500 text-sm",children:N.email}),e.jsx("button",{type:"submit",className:"w-full bg-green-500 text-white font-semibold py-2 rounded-md hover:bg-green-600 transition",children:y.add_member_button}),q&&e.jsx("p",{className:"text-green-500 text-sm mt-2",children:q})]}),e.jsx("input",{type:"text",placeholder:y.search_placeholder,value:m,onChange:c=>x(c.target.value),className:"input w-full border border-gray-300 rounded-md py-2 px-4 mb-4"}),e.jsx("div",{dir:z,children:e.jsx("div",{className:"overflow-y-auto max-h-96 border-t pt-4",children:D.map(c=>e.jsxs("div",{className:"bg-gray-50 shadow-sm rounded-lg p-4 mb-2 relative",children:[e.jsxs("div",{className:"mb-4",children:[e.jsxs("h2",{className:"font-bold text-gray-800",children:[y.parent_name_label,": ",c.parent_name]}),e.jsxs("p",{className:"text-sm text-gray-500",children:[y.kid_name_label,": ",c.kid_name]}),e.jsxs("p",{className:"text-sm mb-8 text-gray-500",children:[y.email_label,": ",c.email||y.no_email_provided]})]}),e.jsx("div",{className:"absolute bottom-4 inset-x-4 flex justify-between items-center",children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>G(c.id),className:"text-gray-600 hover:text-red-600 transition-colors duration-200","aria-label":y.delete_member,children:e.jsx(Ee,{size:20})}),e.jsx("button",{onClick:()=>F(c),className:"p-2 text-gray-600 hover:text-emerald-600 transition-colors duration-200","aria-label":y.edit_member,children:e.jsx(fe,{size:20})})]})})]},c.id))})})]})}async function _e(){return await(await T.get(`${R}/api/available_books`)).data}async function ge(){return await(await T.get(`${R}/api/borrowed_books`)).data}async function or(r){return await(await T.get(`${R}/api/book/${r}`)).data}async function sr(){const r=await $.get("/api/members");return console.log("API Response:",r.data),r.data.members||r.data}const ar=async(r,s,a)=>{try{return(await $.post("/api/book/borrow",{qr_code:r,member_id:s,book_state:a})).data}catch(d){throw console.error("Error borrowing book:",d.response||d),d}},nr=async r=>{try{return(await $.post("/api/book/return",{qr_code:r})).data}catch(s){throw console.error("Error returning book:",s),s}};async function W(r,s){return(await T.get(`${R}/api/loans/history`,{params:{qr_code:r||"",show_all:s?"true":"false"}})).data}const lr=async(r,s,a)=>{var d,u;try{return(await $.post("/api/send-reminder",{loan_id:r,subject:s,loan_details:a})).data}catch(h){return console.error(`Error sending reminder for loan_id ${r}:`,h),{success:!1,error:((u=(d=h.response)==null?void 0:d.data)==null?void 0:u.error)||h.message||"Unknown error"}}},we=async r=>{try{const s=await T.get(`${R}/api/reminders/last/${r}`),{sent_at:a}=s.data;return{sent_at:a}}catch(s){return console.error(`Error fetching last reminder for loan_id ${r}:`,s),null}},ir=({onScanSuccess:r,onScanError:s,onScanCancel:a})=>{const[d,u]=n.useState(!1),h=async(j,v,w={})=>{try{const m=await j.scanFile(v,!0,w);return console.log("Scan attempt succeeded:",m),m}catch(m){throw console.log("Scan attempt failed:",m),m}},f=async j=>{const v=j.target.files[0];if(!v)return;u(!0);const w=new Te("qr-reader");try{const m=[{},{bindSearchRegion:!0,maxLength:512,minLength:1},{returnDetailedScanResult:!0,maxLength:512,minLength:1},{experimentalFeatures:{useBarCodeDetectorIfSupported:!1},maxLength:512,minLength:1}];for(let x=0;x<m.length;x++)try{console.log(`Attempting scan with config ${x+1}:`,m[x]);const N=await h(w,v,m[x]);if(N){w.clear(),r(N);return}}catch(N){console.log(`Config ${x+1} failed:`,N)}throw new Error("Unable to scan QR code with any configuration")}catch(m){console.error("Final error:",m),s(m)}finally{try{await w.clear()}catch(m){console.error("Error clearing scanner:",m)}u(!1)}};return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-lg max-w-md w-full",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Scan QR Code"}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{id:"qr-reader",style:{display:"none"}}),e.jsx("div",{className:"flex flex-col items-center",children:e.jsxs("label",{className:"w-full flex flex-col items-center px-4 py-6 bg-coral text-blue rounded-lg shadow-lg tracking-wide uppercase border border-blue cursor-pointer hover:bg-blue hover:text-white",children:[e.jsx("span",{className:"mt-2 text-base leading-normal",children:"Select an image"}),e.jsx("input",{type:"file",className:"hidden",accept:"image/*",onChange:f,disabled:d})]})}),d&&e.jsx("div",{className:"text-center text-gray-600",children:"Processing image..."}),e.jsx("button",{onClick:a,className:"w-full mt-4 px-4 py-2 bg-gray-200 text-gray-800 rounded hover:bg-gray-300",children:"Cancel"})]})]})})},C={coral:"#F38181",teal:"#4ECAC7",yellow:"#FEC43C"};function dr(){const[r,s]=n.useState(""),[a,d]=n.useState([]),[u,h]=n.useState([]),[f,j]=n.useState(""),[v,w]=n.useState(""),[m,x]=n.useState(null),[N,k]=n.useState(""),[q,_]=n.useState([]),[L,S]=n.useState(""),[z,y]=n.useState(null);n.useState([]);const[M,E]=n.useState([]),[P,Y]=n.useState(!1),[G,F]=n.useState(!1),[H,D]=n.useState(!1),[c,A]=n.useState(!1),[Q,U]=n.useState([]),[Z,ee]=n.useState(!1),{language:i,toggleLanguage:V,direction:ce}=J(),b=X(i);n.useEffect(()=>{(async()=>{try{const[l,p,g]=await Promise.all([sr(),_e(),ge()]);d(l),h(p),_(g)}catch(l){console.error("Error loading initial data:",l)}})()},[]),n.useEffect(()=>{(async()=>{try{let l=null;r==="return"?l=L||null:r==="borrow"&&(l=v||null);const p=await W(l,P),g=await Promise.all(p.map(async B=>{try{const K=await we(B.id);return{...B,last_reminder_date:K?K.sent_at:null}}catch(K){return console.error(`Failed to fetch reminder for loan_id ${B.id}:`,K),{...B,last_reminder_date:null}}}));E(ne(g))}catch(l){console.error("Error fetching loan history:",l),E([])}})()},[P,r,L,v]),n.useEffect(()=>{x(null),w(""),y(null),S(""),k(""),j(null)},[r]);const re=a.map(o=>({value:o.id,label:o.parent_name})),te=u.map(o=>({value:o.qr_code,label:o.title})),oe=o=>{if(!o.returned_at){const l=q.find(p=>p.id===o.book_id);l?(y(l),S(l.qr_code),x(l),k(l.delivery_status||""),window.scrollTo({top:0,behavior:"smooth"})):alert("Book not found in borrowed books.")}},se=(o,l)=>{o.stopPropagation(),o.target.checked?U([...Q,l]):U(Q.filter(p=>p.id!==l.id))},me=async()=>{ee(!0);try{const o=await Promise.all(Q.map(async g=>{try{const B=await lr(g.id,"Book Return Reminder",{borrower_name:g.borrower_name,book_title:g.book_title,borrowed_at:g.borrowed_at});if(B.success){console.log(`Reminder sent successfully for loan_id: ${g.id}`);const K=new Date().toISOString().slice(0,19).replace("T"," ");E(be=>be.map(O=>O.id===g.id?{...O,last_reminder_date:K}:O));const le=await we(g.id);le!=null&&le.sent_at&&E(be=>be.map(O=>O.id===g.id?{...O,last_reminder_date:le.sent_at}:O))}else console.error(`Failed to send reminder for loan_id: ${g.id} - ${B.error}`);return{success:B.success,loanId:g.id,error:B.error}}catch(B){return console.error(`Error sending reminder for loan_id ${g.id}:`,B),{success:!1,loanId:g.id,error:B.message}}})),l=o.filter(g=>g.success).length,p=o.filter(g=>!g.success);if(l>0&&alert(`Sent ${l} reminders successfully!`),p.length>0){const g=p.map(B=>`Loan ID: ${B.loanId} - ${B.error}`).join(`
`);alert(`Failed to send ${p.length} reminders.

${g}`)}U([]),A(!1)}catch(o){console.error("Failed to send reminders:",o),alert("Failed to send reminders. Please check your email service configuration.")}finally{ee(!1)}},ue=async o=>{const l=o.target.checked;Y(l);try{let p=null;r==="return"?p=L||null:r==="borrow"&&(p=v||null);const g=await W(p,l);E(ne(g))}catch(p){console.error("Error fetching loan history:",p),E([])}},ae=async()=>{D(!0),F(!0)},he=async o=>{try{console.log("Handling scan result..."),F(!1),D(!0);const l=await or(o);if(l)if(r==="borrow"?(w(o),x(l)):r==="return"&&(S(o),y(l),x(l),y(l)),k(l.delivery_status),l.loan_status==="borrowed"){const p=await W(o);if(p&&p.length>0){const g=p[0];alert(`The book "${l.title}" was borrowed by ${g.borrower_name} on ${g.borrowed_at}.`)}else alert(`The book "${l.title}" is marked as borrowed, but no loan history is available.`)}else alert(`The book "${l.title}" is available.`);else alert("Book not found for the given QR code.")}catch(l){console.error("Error processing scan result:",l),alert("An error occurred while processing the QR code.")}finally{D(!1)}},pe=o=>{console.error("QR Scan Error:",o),F(!1),D(!1),alert("Failed to scan QR code. Please try again.")},t=()=>{F(!1),D(!1)},I=async()=>{if(f&&m&&N)try{if((await ar(m.qr_code,f.id,N)).message){alert("Book borrowed successfully!"),x(null),j(null),k("");const l=await _e(),p=await ge(),g=await W(null,P);h(l),_(p),E(ne(g))}else alert("Error borrowing book.")}catch(o){console.error("Failed to borrow book:",o)}else alert("Please select a borrower, book, and book state.")},Se=async()=>{if(!L){alert("Please select a book to return.");return}try{if((await nr(L)).success){alert("Book returned successfully!"),y(null),S(""),x(null),k("");const l=await _e(),p=await ge(),g=await W(null,P);h(l),_(p),E(ne(g))}else alert("Failed to return the book. Please try again.")}catch(o){console.error("Error returning book:",o),alert("An error occurred while returning the book. Please try again.")}},ne=o=>o.sort((l,p)=>!l.return_date&&p.return_date?-1:l.return_date&&!p.return_date?1:new Date(p.loan_start_date)-new Date(l.loan_start_date));return e.jsxs("div",{className:"bg-white shadow-md rounded-lg p-6",children:[G&&e.jsx("div",{className:"scanner-modal",children:e.jsx(ir,{onScanSuccess:he,onScanError:pe,onScanCancel:t})}),e.jsxs("div",{className:"flex gap-4 mb-4",children:[e.jsx("div",{className:"absolute top-4 left-4",children:e.jsx("button",{className:"w-12 h-12 flex items-center justify-center rounded-full border border-teal-500 bg-white text-teal-500 shadow-md",onClick:V,children:i==="en"?"HE":"EN"})}),e.jsx("button",{className:`flex-1 py-2 px-4 rounded ${r==="borrow"?"text-white":"text-gray-800"}`,style:{backgroundColor:r==="borrow"?C.coral:"transparent",borderColor:C.coral,borderWidth:"1px"},onClick:()=>s("borrow"),children:b.borrow}),e.jsx("button",{className:`flex-1 py-2 px-4 rounded ${r==="return"?"text-white":"text-gray-800"}`,style:{backgroundColor:r==="return"?C.coral:"transparent",borderColor:C.coral,borderWidth:"1px"},onClick:()=>s("return"),children:b.return})]}),r==="borrow"&&e.jsxs("div",{className:"space-y-4",children:[e.jsx(ye,{options:re,placeholder:b.borrower,value:f?{value:f.id,label:f.parent_name}:null,onChange:o=>{const l=a.find(p=>p.id===(o==null?void 0:o.value));j(l||null)},isClearable:!0,styles:{control:o=>({...o,borderColor:C.coral,borderRadius:"4px",boxShadow:"none","&:hover":{borderColor:C.teal}})},className:"w-full",classNamePrefix:"borrower-select"}),e.jsx(ye,{options:te,placeholder:b.Select_Book,value:m?{value:m.qr_code,label:m.title}:null,onChange:o=>{const l=u.find(p=>p.qr_code===(o==null?void 0:o.value));x(l||null),w((o==null?void 0:o.value)||""),k((l==null?void 0:l.delivery_status)||"")},isClearable:!0,styles:{control:o=>({...o,borderColor:C.coral,borderRadius:"4px",boxShadow:"none","&:hover":{borderColor:C.teal}})},className:"w-full",classNamePrefix:"book-select"}),m&&e.jsxs("div",{className:`bg-gray-100 p-4 rounded mt-4 ${i==="he"?"rtl":""}`,children:[e.jsx("h3",{className:"font-bold text-lg",children:m.title}),e.jsxs("p",{className:"text-sm",children:[b.author,": ",m.author]}),e.jsxs("p",{className:"text-sm",children:[b.description,": ",m.description]}),e.jsxs("p",{className:"text-sm",children:[b.year_of_publication,": ",m.year_of_publication]}),e.jsxs("p",{className:"text-sm",children:[b.cover_type,": ",m.cover_type]}),e.jsxs("p",{className:"text-sm",children:[b.pages,": ",m.pages]}),e.jsxs("p",{className:"text-sm",children:[b.recommended_age,": ",m.recommended_age]}),e.jsxs("p",{className:"text-sm",children:[b.Select_Book_State,": ",m.book_condition]})]}),m&&e.jsxs("select",{className:"w-full p-2 border rounded mt-2",style:{borderColor:C.coral},onChange:o=>k(o.target.value),value:N,children:[e.jsx("option",{value:"",children:b.Select_Book_State}),e.jsx("option",{value:"כמו חדש",children:b.new}),e.jsx("option",{value:"מצויין - בלאי בלתי מורגש",children:b.good}),e.jsx("option",{value:"טוב - בלאי קל",children:b.worn})]}),e.jsxs("button",{className:"w-full flex items-center justify-center py-2 px-4 rounded text-white",style:{backgroundColor:C.coral},onClick:ae,children:[e.jsx(xe,{className:"w-4 h-4 mr-2"}),b.ScanQR]}),e.jsx("button",{className:"w-full py-2 px-4 rounded text-white mt-2",style:{backgroundColor:C.coral},onClick:I,children:b.borrow}),e.jsx("div",{className:`loan-history-container ${i==="he"?"rtl":""}`,children:u.map(o=>e.jsxs("div",{className:`loan-history-card ${(m==null?void 0:m.qr_code)===o.qr_code?"active-loan":""} ${i==="he"?"rtl":""}`,onClick:()=>{x(o),w(o.qr_code),k(o.delivery_status||"")},style:{cursor:"pointer"},children:[e.jsx("div",{className:"loan-history-card-header",children:e.jsx("h3",{className:"loan-history-card-title",children:o.title})}),e.jsxs("div",{className:"loan-history-card-body",children:[e.jsxs("p",{className:"loan-history-card-detail",children:[b.author,": ",o.author]}),e.jsxs("p",{className:"loan-history-card-detail",children:[b.year_of_publication,": ",o.year_of_publication]}),e.jsxs("p",{className:"loan-history-card-detail",children:[b.pages,": ",o.pages]}),e.jsxs("p",{className:"loan-history-card-detail",children:[b.recommended_age,": ",o.recommended_age]})]})]},o.qr_code))})]}),r==="return"&&e.jsxs("div",{className:"mt-6",children:[e.jsx("div",{className:"mt-4",children:e.jsxs("select",{value:L||"",onChange:o=>{const l=o.target.value;S(l);const p=q.find(g=>g.qr_code===l);p&&(x(p),k(p.delivery_status||""))},className:"w-full p-2 border rounded",style:{borderColor:C.coral},children:[e.jsx("option",{value:"",children:b.Select_Book}),q.map(o=>e.jsx("option",{value:o.qr_code,children:o.title},o.qr_code))]})}),e.jsxs("div",{className:"mt-4",children:[e.jsxs("button",{className:"w-full flex items-center justify-center py-2 px-4 rounded text-white",style:{backgroundColor:C.coral},onClick:ae,children:[e.jsx(xe,{className:"w-4 h-4 mr-2"}),b.ScanQR]}),e.jsx("button",{className:"w-full py-2 px-4 rounded text-white mt-2",style:{backgroundColor:C.coral},onClick:Se,disabled:!z,children:b.return}),e.jsxs("button",{className:"w-full flex items-center justify-center py-2 px-4 rounded text-white mt-2",style:{backgroundColor:C.teal},onClick:()=>A(!c),children:[e.jsx(Ae,{className:"w-4 h-4 mr-2"}),b.SendReminders]})]}),e.jsx("div",{className:"flex items-center my-4",children:e.jsxs("label",{className:"ml-4 flex items-center cursor-pointer",children:[e.jsx("input",{id:"checkbox_showall",type:"checkbox",checked:P,onChange:ue,className:"w-4 h-4 text-teal-500 border-gray-300 rounded focus:ring-teal-500 cursor-pointer"}),e.jsx("span",{className:"ml-2",children:b.ShowAllLoans})]})}),c&&M.filter(o=>!o.returned_at).length>0&&e.jsxs("div",{className:"reminder-section bg-gray-100 p-4 rounded-lg mb-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("h3",{className:"text-lg font-semibold",children:b.SendReminders}),e.jsxs("label",{className:"flex items-center cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:Q.length===M.filter(o=>!o.returned_at).length,onChange:o=>{if(o.target.checked){const l=M.filter(p=>!p.returned_at);U(l)}else U([])},className:"w-4 h-4 text-teal-500 border-gray-300 rounded focus:ring-teal-500 cursor-pointer"}),e.jsx("span",{className:"ml-2",children:b.select_all})]})]}),e.jsx("button",{className:"w-full py-2 px-4 rounded text-white",style:{backgroundColor:C.coral},onClick:me,disabled:Q.length===0||Z,children:Z?b.sending_reminders:b.send_x_reminders.replace("{count}",Q.length)})]}),M.length>0&&e.jsx("div",{className:`loan-history-container ${i==="he"?"rtl":""}`,children:M.map(o=>e.jsxs("div",{className:`loan-history-card ${o.returned_at?"":"active-loan"} ${i==="he"?"rtl":""}`,onClick:()=>r==="return"&&oe(o),children:[e.jsxs("div",{className:"loan-history-card-header",children:[c&&!o.returned_at&&e.jsx("div",{onClick:l=>l.stopPropagation(),children:e.jsxs("label",{className:"custom-checkbox",children:[e.jsx("input",{type:"checkbox",checked:Q.some(l=>l.id===o.id),onChange:l=>se(l,o),className:"hidden-checkbox"}),e.jsx("span",{className:"checkbox-mark"})]})}),e.jsx("div",{className:"loan-history-card-title",children:o.book_title})]}),e.jsxs("div",{className:"loan-history-card-body",children:[e.jsxs("div",{className:"loan-history-card-detail",children:[b.borrowed_by,": ",o.borrower_name]}),e.jsxs("div",{className:"loan-history-card-detail",children:[b.borrow_date,": ",o.borrowed_at]}),e.jsxs("div",{className:"loan-history-card-detail",children:[b.return_date,": ",o.returned_at||"Not Returned"]}),e.jsxs("div",{className:"loan-history-card-detail",children:[b.delivery_status,": ",o.book_state||"N/A"]}),e.jsxs("div",{className:"loan-history-card-detail",children:[b.last_reminder,": ",o.last_reminder_date||"No Reminders Sent"]})]})]},o.id))})]})]})}const ke=navigator.language||"en-US",cr=async(r="desc",s="title",a=!0)=>{try{const d=new URLSearchParams({order_by:r,sort_column:s,include_history:a.toString()});return(await T.get(`${R}/api/generate_books_report?${d.toString()}`,{headers:{"Accept-Language":ke},responseType:"blob"})).data}catch(d){throw console.error("Error generating books report:",d),d}},mr=async(r="desc",s="title",a=!1)=>{try{const d=new URLSearchParams({order_by:r,sort_column:s,include_borrowed:a.toString()});return(await T.get(`${R}/api/generate_inventory_report?${d.toString()}`,{headers:{"Accept-Language":ke},responseType:"blob"})).data}catch(d){throw console.error("Error generating inventory report:",d),d}},ur=()=>{const{language:r,toggleLanguage:s}=J(),a=X(r),[d,u]=n.useState(!1),[h,f]=n.useState(!0),[j,v]=n.useState("desc"),[w,m]=n.useState(""),[x,N]=n.useState(""),k={inventory:[{value:"title",label:a.book_title},{value:"author",label:a.author},{value:"id",label:a.id},{value:"loan_status",label:a.loan_status}],loans:[{value:"title",label:a.book_title},{value:"author",label:a.author},{value:"id",label:a.id}]},q=async()=>{try{let _;x==="inventory"?_=await mr(j,w,h):x==="loans"&&(_=await cr(j,w,d));const L=window.URL.createObjectURL(new Blob([_])),S=document.createElement("a");S.href=L,S.setAttribute("download",`${x}_report.xlsx`),document.body.appendChild(S),S.click()}catch(_){console.error("Error generating report:",_),alert(a.error_generating_report)}};return e.jsxs("div",{className:`report-container ${r==="he"?"rtl":""}`,children:[e.jsx("button",{className:"w-12 h-12 flex items-center justify-center rounded-full border border-teal-500 bg-white text-teal-500 shadow-md absolute top-4 left-4",onClick:s,children:r==="en"?"HE":"EN"}),e.jsxs("div",{className:"p-4 bg-white rounded-lg shadow-md",children:[e.jsxs("div",{className:"flex items-center justify-center mb-4",children:[e.jsx(Re,{className:"w-6 h-6 mr-2 text-teal-500"}),e.jsx("h2",{className:"text-xl font-bold text-gray-800",children:a.reports})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[e.jsxs("h3",{className:"text-md font-semibold text-teal-600 mb-3 flex items-center",children:[e.jsx($e,{className:"w-4 h-4 mr-2"}),a.select_report_type]}),e.jsx("div",{className:"space-y-2",children:["inventory","loans"].map(_=>e.jsx("button",{onClick:()=>N(_),className:`w-full p-2 rounded-lg text-left text-sm ${x===_?"bg-teal-500 text-white shadow-md":"bg-white text-gray-700 hover:bg-gray-100 border border-gray-200"}`,children:_==="inventory"?a.inventory_report:a.loans_report},_))})]}),e.jsx("div",{className:`bg-white p-4 rounded-lg border border-gray-100 ${x?"":"opacity-50 pointer-events-none"}`,children:x&&e.jsxs("div",{className:"space-y-3",children:[e.jsxs("h3",{className:"text-md font-semibold text-teal-600 mb-3 flex items-center",children:[e.jsx(qe,{className:"w-4 h-4 mr-2"}),a.report_options]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[x==="loans"&&e.jsxs("div",{className:"flex items-center col-span-2",children:[e.jsx("input",{type:"checkbox",checked:d,onChange:_=>u(_.target.checked),className:"mr-2"}),e.jsx("label",{children:a.include_history})]}),x==="inventory"&&e.jsxs("div",{className:"flex items-center col-span-2",children:[e.jsx("input",{type:"checkbox",checked:h,onChange:_=>f(_.target.checked),className:"mr-2"}),e.jsx("label",{children:a.include_borrowed})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{children:a.sort_by}),e.jsxs("select",{value:w,onChange:_=>m(_.target.value),className:"border rounded-md",children:[e.jsx("option",{value:"",children:a.select_field}),k[x].map(_=>e.jsx("option",{value:_.value,children:_.label},_.value))]})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{children:a.order}),e.jsxs("select",{value:j,onChange:_=>v(_.target.value),className:"border rounded-md",children:[e.jsx("option",{value:"asc",children:a.ascending}),e.jsx("option",{value:"desc",children:a.descending})]})]})]}),e.jsxs("button",{onClick:q,disabled:!w,className:"w-full p-2 bg-teal-500 text-white rounded-md",children:[e.jsx(Me,{className:"w-4 h-4 mr-2"}),a.generate_report_button]})]})})]})]})]})};function hr(){const[r,s]=n.useState(!1),a=()=>{s(!0)};return e.jsx(We,{children:r?e.jsx(pr,{}):e.jsx(He,{onLogin:a})})}function pr(){const{language:r}=J(),s=X(r);return e.jsxs("div",{className:"app-container min-h-screen bg-blend-screen max-w-md mx-auto",children:[e.jsx("header",{className:"bg-white",children:e.jsxs("div",{className:"max-w-md mx-auto flex items-start justify-items-center p-4",children:[e.jsx("img",{src:ve,alt:"ICM Library Logo",className:"max-h-16 sm:max-h-20"}),e.jsx("div",{className:"logo",children:e.jsx("p",{className:"text-sm text-gray-600",children:s.app_title})})]})}),e.jsx("div",{className:"max-w-md mx-auto",children:e.jsxs(Fe,{defaultValue:"inventory",className:"w-full",children:[e.jsxs(Qe,{className:"tabs-list w-full bg-white shadow-md rounded-lg grid grid-cols-4",children:[e.jsxs(ie,{value:"inventory",className:"tab-item flex items-center justify-center data-[state=active]:bg-teal-500 data-[state=active]:text-white text-gray-800 py-2 rounded-t-lg hover:bg-gray-100",children:[e.jsx(Pe,{className:"w-4 h-4 mr-2"}),s.books]}),e.jsxs(ie,{value:"members",className:"tab-item flex items-center justify-center data-[state=active]:bg-[#FDB813] data-[state=active]:text-white text-gray-800 py-2 rounded-t-lg hover:bg-gray-100",children:[e.jsx(De,{className:"w-4 h-4 mr-2"}),s.members]}),e.jsxs(ie,{value:"loans",className:"tab-item flex items-center justify-center data-[state=active]:bg-red-500 data-[state=active]:text-white text-gray-800 py-2 rounded-t-lg hover:bg-gray-100",children:[e.jsx(xe,{className:"w-4 h-4 mr-2"}),s.loans]}),e.jsxs(ie,{value:"reports",className:"tab-item flex items-center justify-center data-[state=active]:bg-purple-500 data-[state=active]:text-white text-gray-800 py-2 rounded-t-lg hover:bg-gray-100",children:[e.jsx(Ie,{className:"w-4 h-4 mr-2"}),s.reports]})]}),e.jsx(de,{value:"inventory",children:e.jsx(rr,{})}),e.jsx(de,{value:"members",children:e.jsx(tr,{})}),e.jsx(de,{value:"loans",children:e.jsx(dr,{})}),e.jsx(de,{value:"reports",children:e.jsx(ur,{})})]})})]})}Ce(document.getElementById("root")).render(e.jsx(n.StrictMode,{children:e.jsx(hr,{})}));
