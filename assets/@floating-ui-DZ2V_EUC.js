const P=Math.min,U=Math.max,O=Math.round,x=Math.floor,F=e=>({x:e,y:e});function j(e){const{x:t,y:n,width:r,height:o}=e;return{width:r,height:o,top:n,left:t,right:t+r,bottom:n+o,x:t,y:n}}function C(){return typeof window<"u"}function V(e){return _(e)?(e.nodeName||"").toLowerCase():"#document"}function g(e){var t;return(e==null||(t=e.ownerDocument)==null?void 0:t.defaultView)||window}function H(e){var t;return(t=(_(e)?e.ownerDocument:e.document)||window.document)==null?void 0:t.documentElement}function _(e){return C()?e instanceof Node||e instanceof g(e).Node:!1}function k(e){return C()?e instanceof Element||e instanceof g(e).Element:!1}function N(e){return C()?e instanceof HTMLElement||e instanceof g(e).HTMLElement:!1}function A(e){return!C()||typeof ShadowRoot>"u"?!1:e instanceof ShadowRoot||e instanceof g(e).ShadowRoot}function I(e){const{overflow:t,overflowX:n,overflowY:r,display:o}=M(e);return/auto|scroll|overlay|hidden|clip/.test(t+r+n)&&!["inline","contents"].includes(o)}function K(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}function X(e){return["html","body","#document"].includes(V(e))}function M(e){return g(e).getComputedStyle(e)}function Y(e){if(V(e)==="html")return e;const t=e.assignedSlot||e.parentNode||A(e)&&e.host||H(e);return A(t)?t.host:t}function $(e){const t=Y(e);return X(t)?e.ownerDocument?e.ownerDocument.body:e.body:N(t)&&I(t)?t:$(t)}function S(e,t,n){var r;t===void 0&&(t=[]),n===void 0&&(n=!0);const o=$(e),c=o===((r=e.ownerDocument)==null?void 0:r.body),i=g(o);if(c){const s=L(i);return t.concat(i,i.visualViewport||[],I(o)?o:[],s&&n?S(s):[])}return t.concat(o,S(o,[],n))}function L(e){return e.parent&&Object.getPrototypeOf(e.parent)?e.frameElement:null}function G(e){const t=M(e);let n=parseFloat(t.width)||0,r=parseFloat(t.height)||0;const o=N(e),c=o?e.offsetWidth:n,i=o?e.offsetHeight:r,s=O(n)!==c||O(r)!==i;return s&&(n=c,r=i),{width:n,height:r,$:s}}function T(e){return k(e)?e:e.contextElement}function B(e){const t=T(e);if(!N(t))return F(1);const n=t.getBoundingClientRect(),{width:r,height:o,$:c}=G(t);let i=(c?O(n.width):n.width)/r,s=(c?O(n.height):n.height)/o;return(!i||!Number.isFinite(i))&&(i=1),(!s||!Number.isFinite(s))&&(s=1),{x:i,y:s}}const J=F(0);function Q(e){const t=g(e);return!K()||!t.visualViewport?J:{x:t.visualViewport.offsetLeft,y:t.visualViewport.offsetTop}}function Z(e,t,n){return!1}function W(e,t,n,r){t===void 0&&(t=!1);const o=e.getBoundingClientRect(),c=T(e);let i=F(1);t&&(i=B(e));const s=Z()?Q(c):F(0);let a=(o.left+s.x)/i.x,u=(o.top+s.y)/i.y,p=o.width/i.x,v=o.height/i.y;if(c){const y=g(c),d=r;let m=y,l=L(m);for(;l&&r&&d!==m;){const h=B(l),f=l.getBoundingClientRect(),w=M(l),b=f.left+(l.clientLeft+parseFloat(w.paddingLeft))*h.x,E=f.top+(l.clientTop+parseFloat(w.paddingTop))*h.y;a*=h.x,u*=h.y,p*=h.x,v*=h.y,a+=b,u+=E,m=g(l),l=L(m)}}return j({width:p,height:v,x:a,y:u})}function q(e,t){return e.x===t.x&&e.y===t.y&&e.width===t.width&&e.height===t.height}function ee(e,t){let n=null,r;const o=H(e);function c(){var s;clearTimeout(r),(s=n)==null||s.disconnect(),n=null}function i(s,a){s===void 0&&(s=!1),a===void 0&&(a=1),c();const u=e.getBoundingClientRect(),{left:p,top:v,width:y,height:d}=u;if(s||t(),!y||!d)return;const m=x(v),l=x(o.clientWidth-(p+y)),h=x(o.clientHeight-(v+d)),f=x(p),b={rootMargin:-m+"px "+-l+"px "+-h+"px "+-f+"px",threshold:U(0,P(1,a))||1};let E=!0;function D(z){const R=z[0].intersectionRatio;if(R!==a){if(!E)return i();R?i(!1,R):r=setTimeout(()=>{i(!1,1e-7)},1e3)}R===1&&!q(u,e.getBoundingClientRect())&&i(),E=!1}try{n=new IntersectionObserver(D,{...b,root:o.ownerDocument})}catch{n=new IntersectionObserver(D,b)}n.observe(e)}return i(!0),c}function te(e,t,n,r){r===void 0&&(r={});const{ancestorScroll:o=!0,ancestorResize:c=!0,elementResize:i=typeof ResizeObserver=="function",layoutShift:s=typeof IntersectionObserver=="function",animationFrame:a=!1}=r,u=T(e),p=o||c?[...u?S(u):[],...S(t)]:[];p.forEach(f=>{o&&f.addEventListener("scroll",n,{passive:!0}),c&&f.addEventListener("resize",n)});const v=u&&s?ee(u,n):null;let y=-1,d=null;i&&(d=new ResizeObserver(f=>{let[w]=f;w&&w.target===u&&d&&(d.unobserve(t),cancelAnimationFrame(y),y=requestAnimationFrame(()=>{var b;(b=d)==null||b.observe(t)})),n()}),u&&!a&&d.observe(u),d.observe(t));let m,l=a?W(e):null;a&&h();function h(){const f=W(e);l&&!q(l,f)&&n(),l=f,m=requestAnimationFrame(h)}return n(),()=>{var f;p.forEach(w=>{o&&w.removeEventListener("scroll",n),c&&w.removeEventListener("resize",n)}),v==null||v(),(f=d)==null||f.disconnect(),d=null,a&&cancelAnimationFrame(m)}}export{te as a};
